{"version":3,"sources":["node_modules/browser-pack/_prelude.js","public/js/app.js","public/js/helpers/ajax.js","public/js/helpers/ajaxspiner.js","public/js/helpers/util.js","public/js/modules/header.js","public/js/modules/search.js","public/js/pages/home.page.js","public/js/pages/learn.page.js","public/js/pages/searchresult.page.js","public/js/pages/wordcrawler.page.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nvar header = require('./modules/header'),\n    util = require('./helpers/util');\n\nvar pages = {\n    homepage: require('./pages/home.page'),\n    searchresultpage: require('./pages/searchresult.page'),\n    learnpage: require('./pages/learn.page'),\n    wordcrawlerpage: require('./pages/wordcrawler.page')\n}\n\nfunction loadJavascriptForPage() {\n    if (typeof window.pageContext === 'undefined' || typeof window.pageContext.pageName === 'undefined') {\n        return;\n    }\n\n    if (typeof pages[window.pageContext.pageName] !== 'undefined') {\n        pages[window.pageContext.pageName].init();\n    }\n}\n\nfunction lookupHighlightText() {\n    if (util.isMobile()) {\n        var selectionEndTimeout;\n        document.onselectionchange = function () {\n            selectionEndTimeout = setTimeout(function () {\n                // reset selection timeout\n                selectionEndTimeout = null;\n                showTranslateButton();\n            }, 500);\n        }\n    } else {\n        $('body').on('mouseup', function (e) {\n            e.preventDefault();\n            showTranslateButton();\n        });\n    }\n\n    $('#translate-text').on('click', function (e) {\n        e.preventDefault();\n        $.magnificPopup.open({                        \n            type: 'ajax',            \n            items: { src: '/api/translate/en-vi' },\n            ajax: {\n                settings: {\n                    method: 'POST',\n                    'content-type': 'application/json',\n                    data: {text :  $('#translate-text').data('text')}\n                }\n            },\n            callbacks: {\n                parseAjax: function(mfpResponse) {\n                    var $translatePopup = $('#translate-popup-wrapper');\n                    $translatePopup.find('.content').html('<p>' + mfpResponse.data.translated + '</p>');\n                    mfpResponse.data = $('#translate-popup-wrapper').html();                \n                },\n                ajaxContentAdded: function() {\n                    // Ajax content is loaded and appended to DOM\n                    //console.log(this.content);\n                }\n            }\n        });\n    });\n\n    // $('#translate-text').magnificPopup({\n    //     type: 'ajax',\n    //     // ajax: {\n    //     //     settings: {\n    //     //         method: 'POST',\n    //     //         'content-type': 'application/json',\n    //     //         data: {text :  $('#translate-text').data('text')}\n    //     //     }\n    //     // },\n    //     callbacks: {\n    //         // parseAjax: function(mfpResponse) {\n    //         //     var $translatePopup = $('#translate-popup-wrapper');\n    //         //     $translatePopup.find('.content').html('<p>' + mfpResponse.data.translated + '</p>');\n    //         //     mfpResponse.data = $('#translate-popup-wrapper').html();                \n    //         // },\n    //         // ajaxContentAdded: function() {\n    //         //     // Ajax content is loaded and appended to DOM\n    //         //     //console.log(this.content);\n    //         // }\n    //         open: function () {\n    //             $.ajax({\n    //                 url: \"/api/translate/en-vi\",\n    //                 method: \"POST\",\n    //                 data: { text: $('#translate-text').data('text') },\n    //                 success: function (data) {\n    //                     if (data.success == true) {\n    //                         var $translatePopup = $('#translate-popup-wrapper');\n    //                         $translatePopup.find('.content').html('<p>' + data.translated + '</p>');\n    //                         parent.html($('#translate-popup-wrapper').html());\n    //                     }\n    //                 }\n    //             });\n    //         }\n    //     }\n    // })\n}\n\nfunction showTranslateButton() {\n    var $translateText = $('#translate-text');\n    var text = '';\n    if (window.getSelection) {\n        text = window.getSelection().toString();\n    } else if (document.selection) {\n        text = document.selection.createRange().text;\n    }\n\n    if (text != '') {\n        $translateText.data('text', text);\n        $translateText.addClass('active');\n    } else {\n        $translateText.removeClass('active');\n    }\n}\n\nvar app = {\n    init: function () {\n        header.init();\n        loadJavascriptForPage();\n        lookupHighlightText();\n    }\n};\n\n$(function () {\n    app.init();\n});","'use strict';\n\nvar ajaxspiner = require('./ajaxspiner'),\n    util = require('./util'),\n    ajax = {};\n\n// function addAccessTokenToAjaxHeader(self, xhr) {\n//     if (window.user.userId !== 0) {\n//         if (typeof window.expat.access_token === 'undefined') {\n//             self.getAccessToken();\n//             if (typeof window.expat.access_token === 'undefined') {\n//                 xhr.abort();\n//             } else {\n//                 xhr.setRequestHeader(\"Authorization\", \"Bearer \" + window.expat.access_token);\n//             }\n//         } else {\n//             xhr.setRequestHeader(\"Authorization\", \"Bearer \" + window.expat.access_token);\n//         }\n//     }\n// }\n\najax.get = function (url, options) {    \n    var deferred = $.Deferred();\n    var ajaxSpinnerInstance;\n    var opts = $.extend({}, options);    \n\n    $.ajax({\n        method: 'GET',\n        url: url,\n        contentType: 'application/json',\n        beforeSend: function (xhr) {\n            // if (opts.isDisplaySpinner !== false) {\n            //     ajaxSpinnerInstance = new AjaxSpinner(opts.spinnerSize, opts.spinnerContainer, opts.isSpinnerLoadingText, opts.isOverlayDiv);\n            //     ajaxSpinnerInstance.startSpinner();\n            // }\n\n            //addAccessTokenToAjaxHeader(self, xhr);\n        },\n        success: function (data) {\n            deferred.resolve(data);\n        },\n        error: function (error) {            \n            deferred.reject(error);\n        },\n        complete: function () {\n            // if (opts.isDisplaySpinner !== true) {\n            //     ajaxSpinnerInstance.stopSpinner();\n            // }\n        }\n    });\n\n    return deferred.promise();\n};\n\n// ajax.delete = function (url, options) {    \n//     var deferred = $.Deferred();\n//     var ajaxSpinnerInstance;\n//     var opts = $.extend({}, options);\n    \n//     $.ajax({\n//         method: 'DELETE',\n//         url: url,\n//         contentType: 'application/json',\n//         beforeSend: function (xhr) {\n//             if (typeof opts.isDisplaySpinner === 'undefined' || opts.isDisplaySpinner === true) {\n//                 ajaxSpinnerInstance = new AjaxSpinner(opts.spinnerSize, opts.spinnerContainer, opts.isSpinnerLoadingText, opts.isOverlayDiv);\n//                 ajaxSpinnerInstance.startSpinner();\n//             }\n\n//             if (url.indexOf('/api/') !== -1) {\n//                 addAccessTokenToAjaxHeader(self, xhr);\n//             }\n//         },\n//         success: function (data) {\n//             deferred.resolve(data);\n//         },\n//         error: function (error) {\n//             window.expat.access_token = undefined;\n//             deferred.reject(error);\n//         },\n//         complete: function () {\n//             if (typeof opts.isDisplaySpinner === 'undefined' || opts.isDisplaySpinner === true) {\n//                 ajaxSpinnerInstance.stopSpinner();\n//             }\n//         }\n//     });\n\n//     return deferred.promise();\n// };\n\n// /*\n//  * - url : api url\n//  * - options\n//  *  + spinnerSize : spinner size (small, medium, large), default is large\n//  *  + spinnerContainer : container to append spinner and overlay, default is body\n//  *  + spinnerContainer : By default, spinner is showed. Set value to false to hide spinner\n//  *  + isSpinnerLoadingText : used to add \"Loading ...\" text under spinner icon\n//  *  + isOverlayDiv : for display overlay div, default is true\n//  * - postData : api post data\n//  */\n// BaseClass.prototype.sendPost = function (url, options, postData) {\n//     var self = this;\n//     var deferred = $.Deferred();\n//     var ajaxSpinnerInstance;\n//     var opts = $.extend({}, options);\n//     postData = $.extend({ LoginUserId: expat.user.userId }, postData);\n\n//     var contentType = typeof opts.contentType !== 'undefined' ? opts.contentType : 'application/x-www-form-urlencoded; charset=UTF-8';\n//     if (opts.isStringify) {\n//         postData = JSON.stringify(postData);\n//     }\n\n//     if (url.indexOf('/api/') !== -1) {\n//         contentType = 'application/json';\n//         postData = JSON.stringify(postData);\n//     }\n//     var ajaxOptions = {\n//         method: 'POST',\n//         url: url,\n//         data: postData,\n//         contentType: contentType,\n//         //dataType: 'json',\n//         beforeSend: function (xhr) {\n//             if (typeof opts.isDisplaySpinner === 'undefined' || opts.isDisplaySpinner === true) {\n//                 ajaxSpinnerInstance = new AjaxSpinner(opts.spinnerSize, opts.spinnerContainer, opts.isSpinnerLoadingText, opts.isOverlayDiv);\n//                 ajaxSpinnerInstance.startSpinner();\n//             }\n\n//             if (url.indexOf('/api/') !== -1) {\n//                 addAccessTokenToAjaxHeader(self, xhr);\n//             }\n//         },\n//         success: function (data) {\n//             deferred.resolve(data);\n//         },\n//         error: function (error) {\n//             window.expat.access_token = undefined;\n//             deferred.reject(error);\n//         },\n//         complete: function () {\n//             if (typeof opts.isDisplaySpinner === 'undefined' || opts.isDisplaySpinner === true) {\n//                 ajaxSpinnerInstance.stopSpinner();\n//             }\n//         }\n//     };\n\n//     $.ajax(ajaxOptions);\n\n//     return deferred.promise();\n// };\n\n// /*\n//  * - url : jquery template url\n//  * - tmplId : template id\n//  * - tmplData : data to bind into template\n//  */\n// BaseClass.prototype.generateTmpl = function (url, tmplId, tmplData) {\n//     var baseClass = this;\n//     var deferred = $.Deferred();\n\n//     var $tmplId = $(tmplId);\n//     if ($tmplId.length) {\n//         deferred.resolve(bindTmpl($tmplId, tmplData));\n//     }\n//     else {\n//         baseClass.sendGet(url, { isDisplaySpinner: false }).done(function (template) {\n//             $('body').append(template);\n//             deferred.resolve(bindTmpl($(tmplId), tmplData));\n//         }).fail(function (error) {\n//             deferred.reject(error);\n//         });\n//     }\n\n//     return deferred;\n// };\n\n// //========================================\n// // Private functions\n\n// function bindTmpl($tmplId, tmplData) {\n//     $.template($tmplId.attr('id'), $tmplId);\n//     if (typeof tmplData !== 'undefined') {\n//         return $.tmpl($tmplId.attr('id'), tmplData);\n//     }\n//     return $.tmpl($tmplId.attr('id'));\n// }\n\n\nmodule.exports = ajax;","'use strict';\n\nvar ajaxspiner = {},\n    spinner,\n    spinnerContainer,\n    defaultOpts = {\n        lines: 11, // The number of lines to draw\n        length: 15, // The length of each line\n        width: 6, // The line thickness\n        radius: 15, // The radius of the inner circle\n        scale: 1, // Scales overall size of the spinner\n        corners: 0.8, // Corner roundness (0..1)\n        color: '#00C3FF', // #rgb or #rrggbb or array of colors\n        opacity: 0.15, // Opacity of the lines\n        rotate: 0, // The rotation offset\n        direction: 1, // 1: clockwise, -1: counterclockwise\n        speed: 1, // Rounds per second\n        trail: 60, // Afterglow percentage\n        fps: 20, // Frames per second when using setTimeout() as a fallback for CSS\n        zIndex: 2e9, // The z-index (defaults to 2000000000)\n        className: 'spinner', // The CSS class to assign to the spinner\n        top: '50%', // Top position relative to parent\n        left: '50%', // Left position relative to parent\n        shadow: false, // Whether to render a shadow\n        hwaccel: false, // Whether to use hardware acceleration\n        position: 'absolute' // Element positioning\n    };\n\najaxspiner.start = function (options) {\n    options = options || {};\n    spinnerContainer = options.spinnerContainer || 'body';\n    var spinnerSize = options.spinnerSize || 'large',\n        isSpinnerLoadingText = options.isSpinnerLoadingText || false,\n        isOverlayDiv = typeof options.isOverlayDiv !== 'undefined' ? options.isOverlayDiv : true,\n        opts;\n\n    switch (spinnerSize) {\n        case 'small':\n            opts = $.extend(defaultOpts, { lines: 11, length: 8, width: 3, radius: 6 });\n            break;\n        case 'medium':\n            opts = $.extend(defaultOpts, { lines: 11, length: 10, width: 5, radius: 11 });\n            break;\n        default: //large size for page\n            opts = defaultOpts;\n            break;\n    }\n    //var baseClass = this;\n    var target = document.querySelector(spinnerContainer);\n\n    //check and add \"position: relative\" for spinner container\n    if (target.style.position !== 'absolute' || target.style.position !== 'relative') {\n        target.style.position = 'relative';\n    }\n\n    //add ajax overlay div\n    if (isOverlayDiv !== false) {\n        var overlayDiv = document.createElement('div');\n        overlayDiv.classList.add('ajax-overlay');\n        target.appendChild(overlayDiv);\n    }\n\n    spinner = new Spinner(opts).spin(target);\n    if (typeof isSpinnerLoadingText !== 'undefined' && isSpinnerLoadingText === true) {\n        var spinnerLoadingTextDiv = document.createElement('div');\n        var textNote = document.createTextNode('Loading more ...');\n        spinnerLoadingTextDiv.appendChild(textNote);\n        spinnerLoadingTextDiv.classList.add('spinnerLoadingText');        \n        spinnerLoadingTextDiv.classList.add(spinnerSize);\n        spinner.el.appendChild(spinnerLoadingTextDiv);\n    }\n};\n\najaxspiner.stop = function () {\n    spinner.stop();\n    $(spinnerContainer).find('.ajax-overlay').remove();\n};\n\nmodule.exports = ajaxspiner;","'use strict';\n\nvar ajaxspiner = require('./ajaxspiner');\n\nfunction isMobile() {\n    var mobileAgentHash = ['mobile', 'tablet', 'phone', 'ipad', 'ipod', 'android', 'blackberry', 'windows ce', 'opera mini', 'palm'];\n    var    idx = 0;\n    var isMobile = false;\n    var userAgent = (navigator.userAgent).toLowerCase();\n\n    while (mobileAgentHash[idx] && !isMobile) {\n        isMobile = (userAgent.indexOf(mobileAgentHash[idx]) >= 0);\n        idx++;\n    }\n    return isMobile;\n}\n\nfunction isAuthenticated() {\n    if(typeof userId !== 'undefined' && userId !== '')\n        return true;\n    return false;\n}\n\nfunction openAjaxPopup(url, popupSelector) {    \n    $.magnificPopup.open({\n        items: {\n            src: popupSelector\n        },\n        callbacks: {\n            beforeOpen: function() {\n                ajaxspiner.start({\n                    spinnerContainer: popupSelector\n                });\n            }\n        }\n    });\n}\n\nvar util = {\n    isMobile: isMobile,\n    isAuthenticated: isAuthenticated,\n    openAjaxPopup: openAjaxPopup\n};\n\nmodule.exports = util;","'use strict';\n\nvar search = require('./search');\n\nfunction toggleMenu() {\n    $('.toggle-menu').on('click', function (e) {\n        e.preventDefault();\n        $('body').toggleClass('mobile-menu');\n    })\n}\n\nfunction init() {\n    toggleMenu();\n    search.init();\n}\n\nmodule.exports = {\n    init: init\n}","'use strict';\n\nvar util = require('../helpers/util');\n\nfunction initpage() {\n    //bind search input\n    var searchType = $('#hdfType').val();\n    var $wordInput = $('#word');\n    if(searchType === 'en-vi') { //en-vi\n        $wordInput.attr('placeholder', 'English - Vietnamese');\n    } else if(searchType === 'en-en') { //en-en\n        $wordInput.attr('placeholder', 'English - English');\n    } else if(searchType === 'vi-en') { //vi-en\n        $wordInput.attr('placeholder', 'Vietnamese - English');\n    }\n\n    //bind data for dict type\n    $('.dict-type li').removeClass('active');\n    $('.dict-type').find('li[data-type=\"' + searchType + '\"]').addClass('active');\n}\n\nfunction searchAutocomplete() {\n    $(\"#word\").on('input', function(e) {        \n        console.time('autocomplete');    \n        var $self = $(this);\n        var word = $self.val().trim();\n        $self.data('word', word);\n        if(word.length < 1) {\n            //$('#btn-clearinput').removeClass('active');\n            bindAutoComplete(null);\n            return;\n        } \n\n        //$('#btn-clearinput').addClass('active');\n\n        var pagesize = 5, wWidth = $(window).outerWidth();\n        if(wWidth >= 768 && wWidth < 1024) {\n            pagesize = 8;\n        } else if (wWidth >= 1024) {\n            pagesize = 20;\n        }\n\n        $.ajax({\n            url: '/api/autocomplete/word/' + $('#hdfType').val() + '/' + pagesize + '/' + $(this).val().trim(),              \n            method: 'GET',\n            dataType: \"json\",\n            success: function (data) {\n                bindAutoComplete(data);                \n                console.timeEnd('autocomplete');                \n            }\n        });     \n    }); \n\n    $('#btn-clearinput').on('click', function(e) {\n        e.preventDefault();\n        console.log('asdsa');\n    });\n}\n\n//private function\nfunction bindAutoComplete(data) {\n    var $searchSuggestion = $('#search-suggestion');    \n    $searchSuggestion.empty(); \n\n    if(data == null || data.length === 0) {\n        $searchSuggestion.trigger('hide');\n        return;\n    }\n\n    var tmplSearchSuggestion = \n    '<ul>' +\n        '{{each words}}' +\n            '<li>' +\n                '<a class=\"autosearch-item\" href=\"/definition/' + $('#hdfType').val() + '/${name}\">' +\n                    '<p class=\"word-name\"><span class=\"name\">${name}</span> <span class=\"phonetic-spelling\">${phoneticSpelling}</span></p>' +\n                    '<p class=\"word-mean\">{{if mainType}}<span class=\"main-type\">[${mainType}]</span>{{/if}} {{if mainViMean}}{{html mainViMean}}{{else}}{{html mainEnMean}}{{/if}}</p>' +\n                '</a>' +                \n            '</li>' +\n        '{{/each}}' +\n    '</ul>';    \n    $.tmpl(tmplSearchSuggestion, {words: data}).appendTo('#search-suggestion');\n    $searchSuggestion.trigger('show');\n}\n\nfunction submitForm() {\n    $('.frmSearch').on('submit', function(e) {\n        //$('#word').attr('disabled', 'true');\n        e.preventDefault();\n        window.location.href = '/definition/' + $('#hdfType').val() + '/' + $('#word').val().trim();\n    });\n}\n\nfunction showHideSearchSuggestion() {\n    $('#search-suggestion').on('show', function(e) {\n        e.preventDefault();        \n        $(this).slideDown();\n        $('.search-section').css({'position': 'absolute'});\n    });\n\n    $('#search-suggestion').on('hide', function(e) {\n        e.preventDefault();\n        $(this).hide();\n        $('.search-section').css({'position': 'fixed'});\n    });\n}\n\nfunction selectSearchType() {\n    var $selectTypeContent = $('.select-types-content');\n    $('.select-icons').on('click', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        $(this).toggleClass('active');\n        $('#search-suggestion').trigger('hide');\n        $selectTypeContent.toggleClass('active');        \n    });\n    \n    $selectTypeContent.on('click', 'li', function(e) {\n        e.preventDefault();\n        var $self = $(this);\n        $selectTypeContent.find('li').removeClass('active');\n        $self.addClass('active');\n        $selectTypeContent.find('#hdfType').val($self.data('type'));\n        $selectTypeContent.removeClass('active');\n        $('.select-icons').removeClass('active');\n        $('#word').attr('placeholder', $self.text()).val('').data('word', '').focus();\n    });\n}\n\nfunction handleClickOnWindow() {  \n    if(/iP/i.test(navigator.userAgent)) {\n        $('*:not(\"a\")').css('cursor', 'pointer');\n    };\n    \n    $(document).click(function() {\n        $('#search-suggestion').trigger('hide');\n        $('.select-types-content').removeClass('active');\n        $('.select-icons').removeClass('active');\n    });\n}\n\nfunction handleKeyDown() {\n    if(util.isMobile()) { \n        console.log('handleKeyDown : isMobile');\n        return;\n    }\n    \n    var $searchSuggestion = $('#search-suggestion');\n    var $inutWord = $('#word');    \n    $inutWord.on('keydown', function(e) {                     \n        if($searchSuggestion.css('display') === 'none') return;        \n\n        var originInputValue = $inutWord.data('word');\n\n        if(e.keyCode === 27) { //esc \n             $searchSuggestion.hide().empty();\n             $inutWord.val(originInputValue);\n        }\n        \n        if(e.keyCode === 38) { //up\n            var $prev = $searchSuggestion.find('li.active').prev();\n            $searchSuggestion.find('li.active').removeClass('active');\n            if($prev.length > 0) {                \n                $prev.addClass('active');\n                $inutWord.val($prev.find('.name').text());\n            } else {\n                $inutWord.val(originInputValue);\n            }\n            e.preventDefault();\n        } else if(e.keyCode === 40) { //down\n            if($searchSuggestion.find('li.active').length > 0) {\n                 $searchSuggestion.find('li:not(:last-child).active').removeClass('active').next().addClass('active');                 \n            } else {\n                $searchSuggestion.find('li:first').addClass('active');\n            }\n            $inutWord.val($searchSuggestion.find('li.active:first').find('.name').text());\n            e.preventDefault();\n        }\n        var $currentItem = $searchSuggestion.find('li.active:first');\n        if($currentItem.length > 0) {\n            $searchSuggestion.scrollTop(0);            \n            $searchSuggestion.scrollTop(($currentItem.position().top - $searchSuggestion.height()) + $currentItem.height());            \n        }        \n    });\n}\n\nfunction init() {    \n    $('#home-page #word').focus();\n    initpage();\n    searchAutocomplete();\n    submitForm();\n    selectSearchType();\n    handleClickOnWindow();    \n    handleKeyDown();\n    showHideSearchSuggestion();\n    //inputFocusOut();\n}\n\nmodule.exports = {\n    init: init\n};\n","'use strict';\nvar util = require('../helpers/util');\n\nfunction handleWindowScroll() {\n    var $window = $(window);\n    $window.scroll(function() {        \n        var $window = $(window);\n        if($window.width() < 1024 || util.isMobile()) return;\n\n        if($window.scrollTop() >= 300) {                \n            $('.search-section').addClass('fix-top').css({'z-index': '99999'});\n            $('.about-section').css({'margin-top': '300px'});\n        } else {                \n            $('.search-section').removeClass('fix-top').css({'z-index': '1'});              \n            $('.about-section').css({'margin-top': '0px'});\n        }  \n    });\n}\n\n\nfunction init() {\n    handleWindowScroll();\n}\n\nmodule.exports = {\n    init: init\n}","'use strict';\n\nfunction resetNotice() {\n    var $notice = $('#notice');\n    $notice.find('.correct').addClass('hide');\n    $notice.find('.incorrect').addClass('hide').text('');\n    $notice.find('.btn-ignore').show();\n    $('.btn-check').text('Check');\n}\n\nfunction check() {\n    var arrQuestions = $('.question-container').toArray(), qIndex = 1;\n    $('.btn-check').on('click', function (e) {\n        e.preventDefault();\n        var $self = $(this),\n            $questionContainer = $self.parents('.question-container'),                       \n            $hdfAnswer = $questionContainer.find('.hdfAnswer');\n\n            console.log(arrQuestions);\n\n        if ($self.text() === 'Check') {\n            var userAnswer = '';\n            // get userAnswer\n            if($questionContainer.data('type') === 1) {\n                userAnswer = $questionContainer.find('input[type=radio]:checked').val().trim().toLowerCase();\n            }\n            if($questionContainer.data('type') === 2 || $questionContainer.data('type') === 3 || $questionContainer.data('type') === 4) {\n                userAnswer = $questionContainer.find('.txt-answer').val().trim();\n            }            \n\n            // answer\n            var answer = $hdfAnswer.val().trim().toLowerCase();\n            \n            if (userAnswer === answer) {\n                $questionContainer.addClass('passed');\n                $('#notice').find('.correct').removeClass('hide');\n                $('#notice').find('.incorrect').addClass('hide');\n                $('#notice').find('.btn-ignore').hide();\n            } else {                \n                $('#notice').find('.correct').addClass('hide');\n                $('#notice').find('.incorrect').removeClass('hide');\n                $('#notice').find('.incorrect').text('Correct is : ' + $questionContainer.find('.hdfAnswer').val());\n                $('#notice').find('.btn-ignore').hide();\n            }          \n\n            $self.text('Continue');\n        } else {\n            $questionContainer.fadeOut(500, function () {                \n                resetNotice();\n                if(arrQuestions.length > qIndex) {\n                    $(arrQuestions[qIndex]).fadeIn(500);\n                    qIndex++;\n                } else {\n                    if($('.question-container:not(.passed)').length > 0) {\n                        arrQuestions = $('.question-container:not(.passed)').toArray();\n                        qIndex = 1;\n                         $('.question-container:not(.passed):first').fadeIn(500);\n                    } else {\n                        $('#finish').removeClass('hide');\n                    }                        \n                }                             \n            });\n        }\n    });\n}\n\nfunction playSound() { \n    $('.sound').on('click', function(e) {\n        e.preventDefault();\n        var audio = new Audio($(this).data('src'));\n        audio.play();\n    })\n}\n\nfunction init() {\n    check();\n    playSound();\n}\n\nmodule.exports = {\n    init: init\n}","'use strict';\n\nvar util = require('../helpers/util'),\n    ajax = require('../helpers/ajax');\n\nfunction initPage() {\n    var $moreExamples = $('.more-examples');\n    $moreExamples.each(function() {\n        if($(this).find('.ex').length === 0) $(this).remove();\n    });\n}\n\nfunction openAddWordPopup() {\n    $('#addToList').on('click', function(e) {\n        e.preventDefault();\n        if(!util.isAuthenticated()) {\n            $.magnificPopup.open({\n                items: {\n                    src: '.authen-popup'                    \n                }\n            });\n            return;\n        } else {\n            $.magnificPopup.open({\n                items: {\n                    src: '.add-to-list-popup'\n                },\n                callbacks: {\n                    beforeOpen: function() {\n                        var options = '';\n                        ajax.get('/api/lists').done(function(lists) {\n                            $.each(lists, function(index, list) {\n                                options += '<option value=\"' + list._id + '\">' + list.title + '</option>';\n                            });\n                            $('.add-to-list-popup #list').empty();\n                            $('.add-to-list-popup #list').append(options);\n                        }).fail(function(err) {\n                            console.log(err);\n                        });\n                    }\n                }\n            });\n        }\n    });\n}\n\nfunction addWordToList() {\n    var $addToListPopup = $('#add-to-list-popup');\n    $addToListPopup.on('click', 'button', function(e) {\n        e.preventDefault();\n        var data = {\n            word: $addToListPopup.find('.hero-title').text(),\n            translateToEn: '',\n            translateToVi: document.getElementById('content_selectable').outerHTML,\n            listId: $addToListPopup.find('#list').val()\n        }\n\n        console.log(data);\n\n        $.ajax({\n            url: '/api/words',\n            method: 'POST',\n            data: data,\n            success: function(result) {\n                console.log(result);\n            },\n            error: function(err) {\n                console.log(err);\n            }\n        })\n    })\n}\n\nfunction selectDictType() {\n    $('.select-dict-type li, .menu-dict-type li').on('click', function(e) {\n        e.preventDefault();\n        window.location.href = '/definition/' + $(this).data('type') + '/' + $('.word-name').text().trim().toLowerCase();\n    });\n}\n\nfunction expandCollapseTypeOfWord() {\n    $('.type-of-word').on('click', function(e) {\n        e.preventDefault();\n        $(this).siblings('.l1-group').slideToggle();\n        $(this).toggleClass('collapsed');\n    })\n}\n\nfunction expandCollapseMoreExamples() {\n    $('.btn-more-exg').on('click', function(e) {\n        e.preventDefault();\n        $(this).siblings('.exg').slideToggle();\n        $(this).toggleClass('collapsed');\n    })\n}\n\nfunction init() {\n    initPage();\n    selectDictType();\n    expandCollapseTypeOfWord();\n    expandCollapseMoreExamples();\n}\n\nmodule.exports = {\n    init: init\n}","'use strict';\n\nfunction submit() {\n    $('#btn-submit').on('click', function(e) {\n        e.preventDefault();\n        console.log('crawler');\n        var postData = {\n            url: $('#url').val(),\n            fromindex: $('#fromindex').val(),\n            toindex: $('#toindex').val()\n        };        \n\n        $.ajax({\n            url: '/api/wordcrawler',\n            method: 'POST',\n            data: postData,\n            success: function(result) {\n                $('#msg').text(result).removeClass('hide');                \n            },\n            error: function(error) {\n                $('#msg').text(error).removeClass('hide');\n            }\n        });\n    });    \n}\n\nfunction init() {\n    submit();\n}\n\nmodule.exports = {\n    init: init\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwdWJsaWMvanMvYXBwLmpzIiwicHVibGljL2pzL2hlbHBlcnMvYWpheC5qcyIsInB1YmxpYy9qcy9oZWxwZXJzL2FqYXhzcGluZXIuanMiLCJwdWJsaWMvanMvaGVscGVycy91dGlsLmpzIiwicHVibGljL2pzL21vZHVsZXMvaGVhZGVyLmpzIiwicHVibGljL2pzL21vZHVsZXMvc2VhcmNoLmpzIiwicHVibGljL2pzL3BhZ2VzL2hvbWUucGFnZS5qcyIsInB1YmxpYy9qcy9wYWdlcy9sZWFybi5wYWdlLmpzIiwicHVibGljL2pzL3BhZ2VzL3NlYXJjaHJlc3VsdC5wYWdlLmpzIiwicHVibGljL2pzL3BhZ2VzL3dvcmRjcmF3bGVyLnBhZ2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIid1c2Ugc3RyaWN0JztcblxudmFyIGhlYWRlciA9IHJlcXVpcmUoJy4vbW9kdWxlcy9oZWFkZXInKSxcbiAgICB1dGlsID0gcmVxdWlyZSgnLi9oZWxwZXJzL3V0aWwnKTtcblxudmFyIHBhZ2VzID0ge1xuICAgIGhvbWVwYWdlOiByZXF1aXJlKCcuL3BhZ2VzL2hvbWUucGFnZScpLFxuICAgIHNlYXJjaHJlc3VsdHBhZ2U6IHJlcXVpcmUoJy4vcGFnZXMvc2VhcmNocmVzdWx0LnBhZ2UnKSxcbiAgICBsZWFybnBhZ2U6IHJlcXVpcmUoJy4vcGFnZXMvbGVhcm4ucGFnZScpLFxuICAgIHdvcmRjcmF3bGVycGFnZTogcmVxdWlyZSgnLi9wYWdlcy93b3JkY3Jhd2xlci5wYWdlJylcbn1cblxuZnVuY3Rpb24gbG9hZEphdmFzY3JpcHRGb3JQYWdlKCkge1xuICAgIGlmICh0eXBlb2Ygd2luZG93LnBhZ2VDb250ZXh0ID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2Ygd2luZG93LnBhZ2VDb250ZXh0LnBhZ2VOYW1lID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBwYWdlc1t3aW5kb3cucGFnZUNvbnRleHQucGFnZU5hbWVdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBwYWdlc1t3aW5kb3cucGFnZUNvbnRleHQucGFnZU5hbWVdLmluaXQoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGxvb2t1cEhpZ2hsaWdodFRleHQoKSB7XG4gICAgaWYgKHV0aWwuaXNNb2JpbGUoKSkge1xuICAgICAgICB2YXIgc2VsZWN0aW9uRW5kVGltZW91dDtcbiAgICAgICAgZG9jdW1lbnQub25zZWxlY3Rpb25jaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxlY3Rpb25FbmRUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gcmVzZXQgc2VsZWN0aW9uIHRpbWVvdXRcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb25FbmRUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzaG93VHJhbnNsYXRlQnV0dG9uKCk7XG4gICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgJCgnYm9keScpLm9uKCdtb3VzZXVwJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHNob3dUcmFuc2xhdGVCdXR0b24oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgJCgnI3RyYW5zbGF0ZS10ZXh0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAkLm1hZ25pZmljUG9wdXAub3Blbih7ICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB0eXBlOiAnYWpheCcsICAgICAgICAgICAgXG4gICAgICAgICAgICBpdGVtczogeyBzcmM6ICcvYXBpL3RyYW5zbGF0ZS9lbi12aScgfSxcbiAgICAgICAgICAgIGFqYXg6IHtcbiAgICAgICAgICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge3RleHQgOiAgJCgnI3RyYW5zbGF0ZS10ZXh0JykuZGF0YSgndGV4dCcpfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYWxsYmFja3M6IHtcbiAgICAgICAgICAgICAgICBwYXJzZUFqYXg6IGZ1bmN0aW9uKG1mcFJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkdHJhbnNsYXRlUG9wdXAgPSAkKCcjdHJhbnNsYXRlLXBvcHVwLXdyYXBwZXInKTtcbiAgICAgICAgICAgICAgICAgICAgJHRyYW5zbGF0ZVBvcHVwLmZpbmQoJy5jb250ZW50JykuaHRtbCgnPHA+JyArIG1mcFJlc3BvbnNlLmRhdGEudHJhbnNsYXRlZCArICc8L3A+Jyk7XG4gICAgICAgICAgICAgICAgICAgIG1mcFJlc3BvbnNlLmRhdGEgPSAkKCcjdHJhbnNsYXRlLXBvcHVwLXdyYXBwZXInKS5odG1sKCk7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYWpheENvbnRlbnRBZGRlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFqYXggY29udGVudCBpcyBsb2FkZWQgYW5kIGFwcGVuZGVkIHRvIERPTVxuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuY29udGVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vICQoJyN0cmFuc2xhdGUtdGV4dCcpLm1hZ25pZmljUG9wdXAoe1xuICAgIC8vICAgICB0eXBlOiAnYWpheCcsXG4gICAgLy8gICAgIC8vIGFqYXg6IHtcbiAgICAvLyAgICAgLy8gICAgIHNldHRpbmdzOiB7XG4gICAgLy8gICAgIC8vICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgLy8gICAgIC8vICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAvLyAgICAgLy8gICAgICAgICBkYXRhOiB7dGV4dCA6ICAkKCcjdHJhbnNsYXRlLXRleHQnKS5kYXRhKCd0ZXh0Jyl9XG4gICAgLy8gICAgIC8vICAgICB9XG4gICAgLy8gICAgIC8vIH0sXG4gICAgLy8gICAgIGNhbGxiYWNrczoge1xuICAgIC8vICAgICAgICAgLy8gcGFyc2VBamF4OiBmdW5jdGlvbihtZnBSZXNwb25zZSkge1xuICAgIC8vICAgICAgICAgLy8gICAgIHZhciAkdHJhbnNsYXRlUG9wdXAgPSAkKCcjdHJhbnNsYXRlLXBvcHVwLXdyYXBwZXInKTtcbiAgICAvLyAgICAgICAgIC8vICAgICAkdHJhbnNsYXRlUG9wdXAuZmluZCgnLmNvbnRlbnQnKS5odG1sKCc8cD4nICsgbWZwUmVzcG9uc2UuZGF0YS50cmFuc2xhdGVkICsgJzwvcD4nKTtcbiAgICAvLyAgICAgICAgIC8vICAgICBtZnBSZXNwb25zZS5kYXRhID0gJCgnI3RyYW5zbGF0ZS1wb3B1cC13cmFwcGVyJykuaHRtbCgpOyAgICAgICAgICAgICAgICBcbiAgICAvLyAgICAgICAgIC8vIH0sXG4gICAgLy8gICAgICAgICAvLyBhamF4Q29udGVudEFkZGVkOiBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgICAgIC8vICAgICAvLyBBamF4IGNvbnRlbnQgaXMgbG9hZGVkIGFuZCBhcHBlbmRlZCB0byBET01cbiAgICAvLyAgICAgICAgIC8vICAgICAvL2NvbnNvbGUubG9nKHRoaXMuY29udGVudCk7XG4gICAgLy8gICAgICAgICAvLyB9XG4gICAgLy8gICAgICAgICBvcGVuOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gICAgICAgICAgICAgJC5hamF4KHtcbiAgICAvLyAgICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvdHJhbnNsYXRlL2VuLXZpXCIsXG4gICAgLy8gICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgLy8gICAgICAgICAgICAgICAgIGRhdGE6IHsgdGV4dDogJCgnI3RyYW5zbGF0ZS10ZXh0JykuZGF0YSgndGV4dCcpIH0sXG4gICAgLy8gICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzID09IHRydWUpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHRyYW5zbGF0ZVBvcHVwID0gJCgnI3RyYW5zbGF0ZS1wb3B1cC13cmFwcGVyJyk7XG4gICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgJHRyYW5zbGF0ZVBvcHVwLmZpbmQoJy5jb250ZW50JykuaHRtbCgnPHA+JyArIGRhdGEudHJhbnNsYXRlZCArICc8L3A+Jyk7XG4gICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Lmh0bWwoJCgnI3RyYW5zbGF0ZS1wb3B1cC13cmFwcGVyJykuaHRtbCgpKTtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgICAgIH0pO1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICB9XG4gICAgLy8gfSlcbn1cblxuZnVuY3Rpb24gc2hvd1RyYW5zbGF0ZUJ1dHRvbigpIHtcbiAgICB2YXIgJHRyYW5zbGF0ZVRleHQgPSAkKCcjdHJhbnNsYXRlLXRleHQnKTtcbiAgICB2YXIgdGV4dCA9ICcnO1xuICAgIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSB7XG4gICAgICAgIHRleHQgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkudG9TdHJpbmcoKTtcbiAgICB9IGVsc2UgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikge1xuICAgICAgICB0ZXh0ID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dDtcbiAgICB9XG5cbiAgICBpZiAodGV4dCAhPSAnJykge1xuICAgICAgICAkdHJhbnNsYXRlVGV4dC5kYXRhKCd0ZXh0JywgdGV4dCk7XG4gICAgICAgICR0cmFuc2xhdGVUZXh0LmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAkdHJhbnNsYXRlVGV4dC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgfVxufVxuXG52YXIgYXBwID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaGVhZGVyLmluaXQoKTtcbiAgICAgICAgbG9hZEphdmFzY3JpcHRGb3JQYWdlKCk7XG4gICAgICAgIGxvb2t1cEhpZ2hsaWdodFRleHQoKTtcbiAgICB9XG59O1xuXG4kKGZ1bmN0aW9uICgpIHtcbiAgICBhcHAuaW5pdCgpO1xufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYWpheHNwaW5lciA9IHJlcXVpcmUoJy4vYWpheHNwaW5lcicpLFxuICAgIHV0aWwgPSByZXF1aXJlKCcuL3V0aWwnKSxcbiAgICBhamF4ID0ge307XG5cbi8vIGZ1bmN0aW9uIGFkZEFjY2Vzc1Rva2VuVG9BamF4SGVhZGVyKHNlbGYsIHhocikge1xuLy8gICAgIGlmICh3aW5kb3cudXNlci51c2VySWQgIT09IDApIHtcbi8vICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuZXhwYXQuYWNjZXNzX3Rva2VuID09PSAndW5kZWZpbmVkJykge1xuLy8gICAgICAgICAgICAgc2VsZi5nZXRBY2Nlc3NUb2tlbigpO1xuLy8gICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuZXhwYXQuYWNjZXNzX3Rva2VuID09PSAndW5kZWZpbmVkJykge1xuLy8gICAgICAgICAgICAgICAgIHhoci5hYm9ydCgpO1xuLy8gICAgICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkF1dGhvcml6YXRpb25cIiwgXCJCZWFyZXIgXCIgKyB3aW5kb3cuZXhwYXQuYWNjZXNzX3Rva2VuKTtcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQXV0aG9yaXphdGlvblwiLCBcIkJlYXJlciBcIiArIHdpbmRvdy5leHBhdC5hY2Nlc3NfdG9rZW4pO1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuXG5hamF4LmdldCA9IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMpIHsgICAgXG4gICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuICAgIHZhciBhamF4U3Bpbm5lckluc3RhbmNlO1xuICAgIHZhciBvcHRzID0gJC5leHRlbmQoe30sIG9wdGlvbnMpOyAgICBcblxuICAgICQuYWpheCh7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIHVybDogdXJsLFxuICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiAoeGhyKSB7XG4gICAgICAgICAgICAvLyBpZiAob3B0cy5pc0Rpc3BsYXlTcGlubmVyICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgLy8gICAgIGFqYXhTcGlubmVySW5zdGFuY2UgPSBuZXcgQWpheFNwaW5uZXIob3B0cy5zcGlubmVyU2l6ZSwgb3B0cy5zcGlubmVyQ29udGFpbmVyLCBvcHRzLmlzU3Bpbm5lckxvYWRpbmdUZXh0LCBvcHRzLmlzT3ZlcmxheURpdik7XG4gICAgICAgICAgICAvLyAgICAgYWpheFNwaW5uZXJJbnN0YW5jZS5zdGFydFNwaW5uZXIoKTtcbiAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgLy9hZGRBY2Nlc3NUb2tlblRvQWpheEhlYWRlcihzZWxmLCB4aHIpO1xuICAgICAgICB9LFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlcnJvcikgeyAgICAgICAgICAgIFxuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSxcbiAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGlmIChvcHRzLmlzRGlzcGxheVNwaW5uZXIgIT09IHRydWUpIHtcbiAgICAgICAgICAgIC8vICAgICBhamF4U3Bpbm5lckluc3RhbmNlLnN0b3BTcGlubmVyKCk7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG59O1xuXG4vLyBhamF4LmRlbGV0ZSA9IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMpIHsgICAgXG4vLyAgICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuLy8gICAgIHZhciBhamF4U3Bpbm5lckluc3RhbmNlO1xuLy8gICAgIHZhciBvcHRzID0gJC5leHRlbmQoe30sIG9wdGlvbnMpO1xuICAgIFxuLy8gICAgICQuYWpheCh7XG4vLyAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4vLyAgICAgICAgIHVybDogdXJsLFxuLy8gICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuLy8gICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiAoeGhyKSB7XG4vLyAgICAgICAgICAgICBpZiAodHlwZW9mIG9wdHMuaXNEaXNwbGF5U3Bpbm5lciA9PT0gJ3VuZGVmaW5lZCcgfHwgb3B0cy5pc0Rpc3BsYXlTcGlubmVyID09PSB0cnVlKSB7XG4vLyAgICAgICAgICAgICAgICAgYWpheFNwaW5uZXJJbnN0YW5jZSA9IG5ldyBBamF4U3Bpbm5lcihvcHRzLnNwaW5uZXJTaXplLCBvcHRzLnNwaW5uZXJDb250YWluZXIsIG9wdHMuaXNTcGlubmVyTG9hZGluZ1RleHQsIG9wdHMuaXNPdmVybGF5RGl2KTtcbi8vICAgICAgICAgICAgICAgICBhamF4U3Bpbm5lckluc3RhbmNlLnN0YXJ0U3Bpbm5lcigpO1xuLy8gICAgICAgICAgICAgfVxuXG4vLyAgICAgICAgICAgICBpZiAodXJsLmluZGV4T2YoJy9hcGkvJykgIT09IC0xKSB7XG4vLyAgICAgICAgICAgICAgICAgYWRkQWNjZXNzVG9rZW5Ub0FqYXhIZWFkZXIoc2VsZiwgeGhyKTtcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgfSxcbi8vICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbi8vICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGF0YSk7XG4vLyAgICAgICAgIH0sXG4vLyAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbi8vICAgICAgICAgICAgIHdpbmRvdy5leHBhdC5hY2Nlc3NfdG9rZW4gPSB1bmRlZmluZWQ7XG4vLyAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuLy8gICAgICAgICB9LFxuLy8gICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuLy8gICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRzLmlzRGlzcGxheVNwaW5uZXIgPT09ICd1bmRlZmluZWQnIHx8IG9wdHMuaXNEaXNwbGF5U3Bpbm5lciA9PT0gdHJ1ZSkge1xuLy8gICAgICAgICAgICAgICAgIGFqYXhTcGlubmVySW5zdGFuY2Uuc3RvcFNwaW5uZXIoKTtcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgfVxuLy8gICAgIH0pO1xuXG4vLyAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbi8vIH07XG5cbi8vIC8qXG4vLyAgKiAtIHVybCA6IGFwaSB1cmxcbi8vICAqIC0gb3B0aW9uc1xuLy8gICogICsgc3Bpbm5lclNpemUgOiBzcGlubmVyIHNpemUgKHNtYWxsLCBtZWRpdW0sIGxhcmdlKSwgZGVmYXVsdCBpcyBsYXJnZVxuLy8gICogICsgc3Bpbm5lckNvbnRhaW5lciA6IGNvbnRhaW5lciB0byBhcHBlbmQgc3Bpbm5lciBhbmQgb3ZlcmxheSwgZGVmYXVsdCBpcyBib2R5XG4vLyAgKiAgKyBzcGlubmVyQ29udGFpbmVyIDogQnkgZGVmYXVsdCwgc3Bpbm5lciBpcyBzaG93ZWQuIFNldCB2YWx1ZSB0byBmYWxzZSB0byBoaWRlIHNwaW5uZXJcbi8vICAqICArIGlzU3Bpbm5lckxvYWRpbmdUZXh0IDogdXNlZCB0byBhZGQgXCJMb2FkaW5nIC4uLlwiIHRleHQgdW5kZXIgc3Bpbm5lciBpY29uXG4vLyAgKiAgKyBpc092ZXJsYXlEaXYgOiBmb3IgZGlzcGxheSBvdmVybGF5IGRpdiwgZGVmYXVsdCBpcyB0cnVlXG4vLyAgKiAtIHBvc3REYXRhIDogYXBpIHBvc3QgZGF0YVxuLy8gICovXG4vLyBCYXNlQ2xhc3MucHJvdG90eXBlLnNlbmRQb3N0ID0gZnVuY3Rpb24gKHVybCwgb3B0aW9ucywgcG9zdERhdGEpIHtcbi8vICAgICB2YXIgc2VsZiA9IHRoaXM7XG4vLyAgICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuLy8gICAgIHZhciBhamF4U3Bpbm5lckluc3RhbmNlO1xuLy8gICAgIHZhciBvcHRzID0gJC5leHRlbmQoe30sIG9wdGlvbnMpO1xuLy8gICAgIHBvc3REYXRhID0gJC5leHRlbmQoeyBMb2dpblVzZXJJZDogZXhwYXQudXNlci51c2VySWQgfSwgcG9zdERhdGEpO1xuXG4vLyAgICAgdmFyIGNvbnRlbnRUeXBlID0gdHlwZW9mIG9wdHMuY29udGVudFR5cGUgIT09ICd1bmRlZmluZWQnID8gb3B0cy5jb250ZW50VHlwZSA6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgnO1xuLy8gICAgIGlmIChvcHRzLmlzU3RyaW5naWZ5KSB7XG4vLyAgICAgICAgIHBvc3REYXRhID0gSlNPTi5zdHJpbmdpZnkocG9zdERhdGEpO1xuLy8gICAgIH1cblxuLy8gICAgIGlmICh1cmwuaW5kZXhPZignL2FwaS8nKSAhPT0gLTEpIHtcbi8vICAgICAgICAgY29udGVudFR5cGUgPSAnYXBwbGljYXRpb24vanNvbic7XG4vLyAgICAgICAgIHBvc3REYXRhID0gSlNPTi5zdHJpbmdpZnkocG9zdERhdGEpO1xuLy8gICAgIH1cbi8vICAgICB2YXIgYWpheE9wdGlvbnMgPSB7XG4vLyAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuLy8gICAgICAgICB1cmw6IHVybCxcbi8vICAgICAgICAgZGF0YTogcG9zdERhdGEsXG4vLyAgICAgICAgIGNvbnRlbnRUeXBlOiBjb250ZW50VHlwZSxcbi8vICAgICAgICAgLy9kYXRhVHlwZTogJ2pzb24nLFxuLy8gICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiAoeGhyKSB7XG4vLyAgICAgICAgICAgICBpZiAodHlwZW9mIG9wdHMuaXNEaXNwbGF5U3Bpbm5lciA9PT0gJ3VuZGVmaW5lZCcgfHwgb3B0cy5pc0Rpc3BsYXlTcGlubmVyID09PSB0cnVlKSB7XG4vLyAgICAgICAgICAgICAgICAgYWpheFNwaW5uZXJJbnN0YW5jZSA9IG5ldyBBamF4U3Bpbm5lcihvcHRzLnNwaW5uZXJTaXplLCBvcHRzLnNwaW5uZXJDb250YWluZXIsIG9wdHMuaXNTcGlubmVyTG9hZGluZ1RleHQsIG9wdHMuaXNPdmVybGF5RGl2KTtcbi8vICAgICAgICAgICAgICAgICBhamF4U3Bpbm5lckluc3RhbmNlLnN0YXJ0U3Bpbm5lcigpO1xuLy8gICAgICAgICAgICAgfVxuXG4vLyAgICAgICAgICAgICBpZiAodXJsLmluZGV4T2YoJy9hcGkvJykgIT09IC0xKSB7XG4vLyAgICAgICAgICAgICAgICAgYWRkQWNjZXNzVG9rZW5Ub0FqYXhIZWFkZXIoc2VsZiwgeGhyKTtcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgfSxcbi8vICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbi8vICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGF0YSk7XG4vLyAgICAgICAgIH0sXG4vLyAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbi8vICAgICAgICAgICAgIHdpbmRvdy5leHBhdC5hY2Nlc3NfdG9rZW4gPSB1bmRlZmluZWQ7XG4vLyAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuLy8gICAgICAgICB9LFxuLy8gICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuLy8gICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRzLmlzRGlzcGxheVNwaW5uZXIgPT09ICd1bmRlZmluZWQnIHx8IG9wdHMuaXNEaXNwbGF5U3Bpbm5lciA9PT0gdHJ1ZSkge1xuLy8gICAgICAgICAgICAgICAgIGFqYXhTcGlubmVySW5zdGFuY2Uuc3RvcFNwaW5uZXIoKTtcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgfVxuLy8gICAgIH07XG5cbi8vICAgICAkLmFqYXgoYWpheE9wdGlvbnMpO1xuXG4vLyAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbi8vIH07XG5cbi8vIC8qXG4vLyAgKiAtIHVybCA6IGpxdWVyeSB0ZW1wbGF0ZSB1cmxcbi8vICAqIC0gdG1wbElkIDogdGVtcGxhdGUgaWRcbi8vICAqIC0gdG1wbERhdGEgOiBkYXRhIHRvIGJpbmQgaW50byB0ZW1wbGF0ZVxuLy8gICovXG4vLyBCYXNlQ2xhc3MucHJvdG90eXBlLmdlbmVyYXRlVG1wbCA9IGZ1bmN0aW9uICh1cmwsIHRtcGxJZCwgdG1wbERhdGEpIHtcbi8vICAgICB2YXIgYmFzZUNsYXNzID0gdGhpcztcbi8vICAgICB2YXIgZGVmZXJyZWQgPSAkLkRlZmVycmVkKCk7XG5cbi8vICAgICB2YXIgJHRtcGxJZCA9ICQodG1wbElkKTtcbi8vICAgICBpZiAoJHRtcGxJZC5sZW5ndGgpIHtcbi8vICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShiaW5kVG1wbCgkdG1wbElkLCB0bXBsRGF0YSkpO1xuLy8gICAgIH1cbi8vICAgICBlbHNlIHtcbi8vICAgICAgICAgYmFzZUNsYXNzLnNlbmRHZXQodXJsLCB7IGlzRGlzcGxheVNwaW5uZXI6IGZhbHNlIH0pLmRvbmUoZnVuY3Rpb24gKHRlbXBsYXRlKSB7XG4vLyAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKHRlbXBsYXRlKTtcbi8vICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoYmluZFRtcGwoJCh0bXBsSWQpLCB0bXBsRGF0YSkpO1xuLy8gICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uIChlcnJvcikge1xuLy8gICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbi8vICAgICAgICAgfSk7XG4vLyAgICAgfVxuXG4vLyAgICAgcmV0dXJuIGRlZmVycmVkO1xuLy8gfTtcblxuLy8gLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyAvLyBQcml2YXRlIGZ1bmN0aW9uc1xuXG4vLyBmdW5jdGlvbiBiaW5kVG1wbCgkdG1wbElkLCB0bXBsRGF0YSkge1xuLy8gICAgICQudGVtcGxhdGUoJHRtcGxJZC5hdHRyKCdpZCcpLCAkdG1wbElkKTtcbi8vICAgICBpZiAodHlwZW9mIHRtcGxEYXRhICE9PSAndW5kZWZpbmVkJykge1xuLy8gICAgICAgICByZXR1cm4gJC50bXBsKCR0bXBsSWQuYXR0cignaWQnKSwgdG1wbERhdGEpO1xuLy8gICAgIH1cbi8vICAgICByZXR1cm4gJC50bXBsKCR0bXBsSWQuYXR0cignaWQnKSk7XG4vLyB9XG5cblxubW9kdWxlLmV4cG9ydHMgPSBhamF4OyIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFqYXhzcGluZXIgPSB7fSxcbiAgICBzcGlubmVyLFxuICAgIHNwaW5uZXJDb250YWluZXIsXG4gICAgZGVmYXVsdE9wdHMgPSB7XG4gICAgICAgIGxpbmVzOiAxMSwgLy8gVGhlIG51bWJlciBvZiBsaW5lcyB0byBkcmF3XG4gICAgICAgIGxlbmd0aDogMTUsIC8vIFRoZSBsZW5ndGggb2YgZWFjaCBsaW5lXG4gICAgICAgIHdpZHRoOiA2LCAvLyBUaGUgbGluZSB0aGlja25lc3NcbiAgICAgICAgcmFkaXVzOiAxNSwgLy8gVGhlIHJhZGl1cyBvZiB0aGUgaW5uZXIgY2lyY2xlXG4gICAgICAgIHNjYWxlOiAxLCAvLyBTY2FsZXMgb3ZlcmFsbCBzaXplIG9mIHRoZSBzcGlubmVyXG4gICAgICAgIGNvcm5lcnM6IDAuOCwgLy8gQ29ybmVyIHJvdW5kbmVzcyAoMC4uMSlcbiAgICAgICAgY29sb3I6ICcjMDBDM0ZGJywgLy8gI3JnYiBvciAjcnJnZ2JiIG9yIGFycmF5IG9mIGNvbG9yc1xuICAgICAgICBvcGFjaXR5OiAwLjE1LCAvLyBPcGFjaXR5IG9mIHRoZSBsaW5lc1xuICAgICAgICByb3RhdGU6IDAsIC8vIFRoZSByb3RhdGlvbiBvZmZzZXRcbiAgICAgICAgZGlyZWN0aW9uOiAxLCAvLyAxOiBjbG9ja3dpc2UsIC0xOiBjb3VudGVyY2xvY2t3aXNlXG4gICAgICAgIHNwZWVkOiAxLCAvLyBSb3VuZHMgcGVyIHNlY29uZFxuICAgICAgICB0cmFpbDogNjAsIC8vIEFmdGVyZ2xvdyBwZXJjZW50YWdlXG4gICAgICAgIGZwczogMjAsIC8vIEZyYW1lcyBwZXIgc2Vjb25kIHdoZW4gdXNpbmcgc2V0VGltZW91dCgpIGFzIGEgZmFsbGJhY2sgZm9yIENTU1xuICAgICAgICB6SW5kZXg6IDJlOSwgLy8gVGhlIHotaW5kZXggKGRlZmF1bHRzIHRvIDIwMDAwMDAwMDApXG4gICAgICAgIGNsYXNzTmFtZTogJ3NwaW5uZXInLCAvLyBUaGUgQ1NTIGNsYXNzIHRvIGFzc2lnbiB0byB0aGUgc3Bpbm5lclxuICAgICAgICB0b3A6ICc1MCUnLCAvLyBUb3AgcG9zaXRpb24gcmVsYXRpdmUgdG8gcGFyZW50XG4gICAgICAgIGxlZnQ6ICc1MCUnLCAvLyBMZWZ0IHBvc2l0aW9uIHJlbGF0aXZlIHRvIHBhcmVudFxuICAgICAgICBzaGFkb3c6IGZhbHNlLCAvLyBXaGV0aGVyIHRvIHJlbmRlciBhIHNoYWRvd1xuICAgICAgICBod2FjY2VsOiBmYWxzZSwgLy8gV2hldGhlciB0byB1c2UgaGFyZHdhcmUgYWNjZWxlcmF0aW9uXG4gICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnIC8vIEVsZW1lbnQgcG9zaXRpb25pbmdcbiAgICB9O1xuXG5hamF4c3BpbmVyLnN0YXJ0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBzcGlubmVyQ29udGFpbmVyID0gb3B0aW9ucy5zcGlubmVyQ29udGFpbmVyIHx8ICdib2R5JztcbiAgICB2YXIgc3Bpbm5lclNpemUgPSBvcHRpb25zLnNwaW5uZXJTaXplIHx8ICdsYXJnZScsXG4gICAgICAgIGlzU3Bpbm5lckxvYWRpbmdUZXh0ID0gb3B0aW9ucy5pc1NwaW5uZXJMb2FkaW5nVGV4dCB8fCBmYWxzZSxcbiAgICAgICAgaXNPdmVybGF5RGl2ID0gdHlwZW9mIG9wdGlvbnMuaXNPdmVybGF5RGl2ICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaXNPdmVybGF5RGl2IDogdHJ1ZSxcbiAgICAgICAgb3B0cztcblxuICAgIHN3aXRjaCAoc3Bpbm5lclNpemUpIHtcbiAgICAgICAgY2FzZSAnc21hbGwnOlxuICAgICAgICAgICAgb3B0cyA9ICQuZXh0ZW5kKGRlZmF1bHRPcHRzLCB7IGxpbmVzOiAxMSwgbGVuZ3RoOiA4LCB3aWR0aDogMywgcmFkaXVzOiA2IH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ21lZGl1bSc6XG4gICAgICAgICAgICBvcHRzID0gJC5leHRlbmQoZGVmYXVsdE9wdHMsIHsgbGluZXM6IDExLCBsZW5ndGg6IDEwLCB3aWR0aDogNSwgcmFkaXVzOiAxMSB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OiAvL2xhcmdlIHNpemUgZm9yIHBhZ2VcbiAgICAgICAgICAgIG9wdHMgPSBkZWZhdWx0T3B0cztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICAvL3ZhciBiYXNlQ2xhc3MgPSB0aGlzO1xuICAgIHZhciB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNwaW5uZXJDb250YWluZXIpO1xuXG4gICAgLy9jaGVjayBhbmQgYWRkIFwicG9zaXRpb246IHJlbGF0aXZlXCIgZm9yIHNwaW5uZXIgY29udGFpbmVyXG4gICAgaWYgKHRhcmdldC5zdHlsZS5wb3NpdGlvbiAhPT0gJ2Fic29sdXRlJyB8fCB0YXJnZXQuc3R5bGUucG9zaXRpb24gIT09ICdyZWxhdGl2ZScpIHtcbiAgICAgICAgdGFyZ2V0LnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICB9XG5cbiAgICAvL2FkZCBhamF4IG92ZXJsYXkgZGl2XG4gICAgaWYgKGlzT3ZlcmxheURpdiAhPT0gZmFsc2UpIHtcbiAgICAgICAgdmFyIG92ZXJsYXlEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgb3ZlcmxheURpdi5jbGFzc0xpc3QuYWRkKCdhamF4LW92ZXJsYXknKTtcbiAgICAgICAgdGFyZ2V0LmFwcGVuZENoaWxkKG92ZXJsYXlEaXYpO1xuICAgIH1cblxuICAgIHNwaW5uZXIgPSBuZXcgU3Bpbm5lcihvcHRzKS5zcGluKHRhcmdldCk7XG4gICAgaWYgKHR5cGVvZiBpc1NwaW5uZXJMb2FkaW5nVGV4dCAhPT0gJ3VuZGVmaW5lZCcgJiYgaXNTcGlubmVyTG9hZGluZ1RleHQgPT09IHRydWUpIHtcbiAgICAgICAgdmFyIHNwaW5uZXJMb2FkaW5nVGV4dERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB2YXIgdGV4dE5vdGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnTG9hZGluZyBtb3JlIC4uLicpO1xuICAgICAgICBzcGlubmVyTG9hZGluZ1RleHREaXYuYXBwZW5kQ2hpbGQodGV4dE5vdGUpO1xuICAgICAgICBzcGlubmVyTG9hZGluZ1RleHREaXYuY2xhc3NMaXN0LmFkZCgnc3Bpbm5lckxvYWRpbmdUZXh0Jyk7ICAgICAgICBcbiAgICAgICAgc3Bpbm5lckxvYWRpbmdUZXh0RGl2LmNsYXNzTGlzdC5hZGQoc3Bpbm5lclNpemUpO1xuICAgICAgICBzcGlubmVyLmVsLmFwcGVuZENoaWxkKHNwaW5uZXJMb2FkaW5nVGV4dERpdik7XG4gICAgfVxufTtcblxuYWpheHNwaW5lci5zdG9wID0gZnVuY3Rpb24gKCkge1xuICAgIHNwaW5uZXIuc3RvcCgpO1xuICAgICQoc3Bpbm5lckNvbnRhaW5lcikuZmluZCgnLmFqYXgtb3ZlcmxheScpLnJlbW92ZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBhamF4c3BpbmVyOyIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFqYXhzcGluZXIgPSByZXF1aXJlKCcuL2FqYXhzcGluZXInKTtcblxuZnVuY3Rpb24gaXNNb2JpbGUoKSB7XG4gICAgdmFyIG1vYmlsZUFnZW50SGFzaCA9IFsnbW9iaWxlJywgJ3RhYmxldCcsICdwaG9uZScsICdpcGFkJywgJ2lwb2QnLCAnYW5kcm9pZCcsICdibGFja2JlcnJ5JywgJ3dpbmRvd3MgY2UnLCAnb3BlcmEgbWluaScsICdwYWxtJ107XG4gICAgdmFyICAgIGlkeCA9IDA7XG4gICAgdmFyIGlzTW9iaWxlID0gZmFsc2U7XG4gICAgdmFyIHVzZXJBZ2VudCA9IChuYXZpZ2F0b3IudXNlckFnZW50KS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgd2hpbGUgKG1vYmlsZUFnZW50SGFzaFtpZHhdICYmICFpc01vYmlsZSkge1xuICAgICAgICBpc01vYmlsZSA9ICh1c2VyQWdlbnQuaW5kZXhPZihtb2JpbGVBZ2VudEhhc2hbaWR4XSkgPj0gMCk7XG4gICAgICAgIGlkeCsrO1xuICAgIH1cbiAgICByZXR1cm4gaXNNb2JpbGU7XG59XG5cbmZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICBpZih0eXBlb2YgdXNlcklkICE9PSAndW5kZWZpbmVkJyAmJiB1c2VySWQgIT09ICcnKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIG9wZW5BamF4UG9wdXAodXJsLCBwb3B1cFNlbGVjdG9yKSB7ICAgIFxuICAgICQubWFnbmlmaWNQb3B1cC5vcGVuKHtcbiAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgIHNyYzogcG9wdXBTZWxlY3RvclxuICAgICAgICB9LFxuICAgICAgICBjYWxsYmFja3M6IHtcbiAgICAgICAgICAgIGJlZm9yZU9wZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGFqYXhzcGluZXIuc3RhcnQoe1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyQ29udGFpbmVyOiBwb3B1cFNlbGVjdG9yXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxudmFyIHV0aWwgPSB7XG4gICAgaXNNb2JpbGU6IGlzTW9iaWxlLFxuICAgIGlzQXV0aGVudGljYXRlZDogaXNBdXRoZW50aWNhdGVkLFxuICAgIG9wZW5BamF4UG9wdXA6IG9wZW5BamF4UG9wdXBcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gdXRpbDsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBzZWFyY2ggPSByZXF1aXJlKCcuL3NlYXJjaCcpO1xuXG5mdW5jdGlvbiB0b2dnbGVNZW51KCkge1xuICAgICQoJy50b2dnbGUtbWVudScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgJCgnYm9keScpLnRvZ2dsZUNsYXNzKCdtb2JpbGUtbWVudScpO1xuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdG9nZ2xlTWVudSgpO1xuICAgIHNlYXJjaC5pbml0KCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGluaXQ6IGluaXRcbn0iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgnLi4vaGVscGVycy91dGlsJyk7XG5cbmZ1bmN0aW9uIGluaXRwYWdlKCkge1xuICAgIC8vYmluZCBzZWFyY2ggaW5wdXRcbiAgICB2YXIgc2VhcmNoVHlwZSA9ICQoJyNoZGZUeXBlJykudmFsKCk7XG4gICAgdmFyICR3b3JkSW5wdXQgPSAkKCcjd29yZCcpO1xuICAgIGlmKHNlYXJjaFR5cGUgPT09ICdlbi12aScpIHsgLy9lbi12aVxuICAgICAgICAkd29yZElucHV0LmF0dHIoJ3BsYWNlaG9sZGVyJywgJ0VuZ2xpc2ggLSBWaWV0bmFtZXNlJyk7XG4gICAgfSBlbHNlIGlmKHNlYXJjaFR5cGUgPT09ICdlbi1lbicpIHsgLy9lbi1lblxuICAgICAgICAkd29yZElucHV0LmF0dHIoJ3BsYWNlaG9sZGVyJywgJ0VuZ2xpc2ggLSBFbmdsaXNoJyk7XG4gICAgfSBlbHNlIGlmKHNlYXJjaFR5cGUgPT09ICd2aS1lbicpIHsgLy92aS1lblxuICAgICAgICAkd29yZElucHV0LmF0dHIoJ3BsYWNlaG9sZGVyJywgJ1ZpZXRuYW1lc2UgLSBFbmdsaXNoJyk7XG4gICAgfVxuXG4gICAgLy9iaW5kIGRhdGEgZm9yIGRpY3QgdHlwZVxuICAgICQoJy5kaWN0LXR5cGUgbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgJCgnLmRpY3QtdHlwZScpLmZpbmQoJ2xpW2RhdGEtdHlwZT1cIicgKyBzZWFyY2hUeXBlICsgJ1wiXScpLmFkZENsYXNzKCdhY3RpdmUnKTtcbn1cblxuZnVuY3Rpb24gc2VhcmNoQXV0b2NvbXBsZXRlKCkge1xuICAgICQoXCIjd29yZFwiKS5vbignaW5wdXQnLCBmdW5jdGlvbihlKSB7ICAgICAgICBcbiAgICAgICAgY29uc29sZS50aW1lKCdhdXRvY29tcGxldGUnKTsgICAgXG4gICAgICAgIHZhciAkc2VsZiA9ICQodGhpcyk7XG4gICAgICAgIHZhciB3b3JkID0gJHNlbGYudmFsKCkudHJpbSgpO1xuICAgICAgICAkc2VsZi5kYXRhKCd3b3JkJywgd29yZCk7XG4gICAgICAgIGlmKHdvcmQubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgLy8kKCcjYnRuLWNsZWFyaW5wdXQnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICBiaW5kQXV0b0NvbXBsZXRlKG51bGwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IFxuXG4gICAgICAgIC8vJCgnI2J0bi1jbGVhcmlucHV0JykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgIHZhciBwYWdlc2l6ZSA9IDUsIHdXaWR0aCA9ICQod2luZG93KS5vdXRlcldpZHRoKCk7XG4gICAgICAgIGlmKHdXaWR0aCA+PSA3NjggJiYgd1dpZHRoIDwgMTAyNCkge1xuICAgICAgICAgICAgcGFnZXNpemUgPSA4O1xuICAgICAgICB9IGVsc2UgaWYgKHdXaWR0aCA+PSAxMDI0KSB7XG4gICAgICAgICAgICBwYWdlc2l6ZSA9IDIwO1xuICAgICAgICB9XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy9hcGkvYXV0b2NvbXBsZXRlL3dvcmQvJyArICQoJyNoZGZUeXBlJykudmFsKCkgKyAnLycgKyBwYWdlc2l6ZSArICcvJyArICQodGhpcykudmFsKCkudHJpbSgpLCAgICAgICAgICAgICAgXG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBiaW5kQXV0b0NvbXBsZXRlKGRhdGEpOyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zb2xlLnRpbWVFbmQoJ2F1dG9jb21wbGV0ZScpOyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7ICAgICBcbiAgICB9KTsgXG5cbiAgICAkKCcjYnRuLWNsZWFyaW5wdXQnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc29sZS5sb2coJ2FzZHNhJyk7XG4gICAgfSk7XG59XG5cbi8vcHJpdmF0ZSBmdW5jdGlvblxuZnVuY3Rpb24gYmluZEF1dG9Db21wbGV0ZShkYXRhKSB7XG4gICAgdmFyICRzZWFyY2hTdWdnZXN0aW9uID0gJCgnI3NlYXJjaC1zdWdnZXN0aW9uJyk7ICAgIFxuICAgICRzZWFyY2hTdWdnZXN0aW9uLmVtcHR5KCk7IFxuXG4gICAgaWYoZGF0YSA9PSBudWxsIHx8IGRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICRzZWFyY2hTdWdnZXN0aW9uLnRyaWdnZXIoJ2hpZGUnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciB0bXBsU2VhcmNoU3VnZ2VzdGlvbiA9IFxuICAgICc8dWw+JyArXG4gICAgICAgICd7e2VhY2ggd29yZHN9fScgK1xuICAgICAgICAgICAgJzxsaT4nICtcbiAgICAgICAgICAgICAgICAnPGEgY2xhc3M9XCJhdXRvc2VhcmNoLWl0ZW1cIiBocmVmPVwiL2RlZmluaXRpb24vJyArICQoJyNoZGZUeXBlJykudmFsKCkgKyAnLyR7bmFtZX1cIj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxwIGNsYXNzPVwid29yZC1uYW1lXCI+PHNwYW4gY2xhc3M9XCJuYW1lXCI+JHtuYW1lfTwvc3Bhbj4gPHNwYW4gY2xhc3M9XCJwaG9uZXRpYy1zcGVsbGluZ1wiPiR7cGhvbmV0aWNTcGVsbGluZ308L3NwYW4+PC9wPicgK1xuICAgICAgICAgICAgICAgICAgICAnPHAgY2xhc3M9XCJ3b3JkLW1lYW5cIj57e2lmIG1haW5UeXBlfX08c3BhbiBjbGFzcz1cIm1haW4tdHlwZVwiPlske21haW5UeXBlfV08L3NwYW4+e3svaWZ9fSB7e2lmIG1haW5WaU1lYW59fXt7aHRtbCBtYWluVmlNZWFufX17e2Vsc2V9fXt7aHRtbCBtYWluRW5NZWFufX17ey9pZn19PC9wPicgK1xuICAgICAgICAgICAgICAgICc8L2E+JyArICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgJzwvbGk+JyArXG4gICAgICAgICd7ey9lYWNofX0nICtcbiAgICAnPC91bD4nOyAgICBcbiAgICAkLnRtcGwodG1wbFNlYXJjaFN1Z2dlc3Rpb24sIHt3b3JkczogZGF0YX0pLmFwcGVuZFRvKCcjc2VhcmNoLXN1Z2dlc3Rpb24nKTtcbiAgICAkc2VhcmNoU3VnZ2VzdGlvbi50cmlnZ2VyKCdzaG93Jyk7XG59XG5cbmZ1bmN0aW9uIHN1Ym1pdEZvcm0oKSB7XG4gICAgJCgnLmZybVNlYXJjaCcpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIC8vJCgnI3dvcmQnKS5hdHRyKCdkaXNhYmxlZCcsICd0cnVlJyk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2RlZmluaXRpb24vJyArICQoJyNoZGZUeXBlJykudmFsKCkgKyAnLycgKyAkKCcjd29yZCcpLnZhbCgpLnRyaW0oKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc2hvd0hpZGVTZWFyY2hTdWdnZXN0aW9uKCkge1xuICAgICQoJyNzZWFyY2gtc3VnZ2VzdGlvbicpLm9uKCdzaG93JywgZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7ICAgICAgICBcbiAgICAgICAgJCh0aGlzKS5zbGlkZURvd24oKTtcbiAgICAgICAgJCgnLnNlYXJjaC1zZWN0aW9uJykuY3NzKHsncG9zaXRpb24nOiAnYWJzb2x1dGUnfSk7XG4gICAgfSk7XG5cbiAgICAkKCcjc2VhcmNoLXN1Z2dlc3Rpb24nKS5vbignaGlkZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAkKHRoaXMpLmhpZGUoKTtcbiAgICAgICAgJCgnLnNlYXJjaC1zZWN0aW9uJykuY3NzKHsncG9zaXRpb24nOiAnZml4ZWQnfSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHNlbGVjdFNlYXJjaFR5cGUoKSB7XG4gICAgdmFyICRzZWxlY3RUeXBlQ29udGVudCA9ICQoJy5zZWxlY3QtdHlwZXMtY29udGVudCcpO1xuICAgICQoJy5zZWxlY3QtaWNvbnMnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgJCh0aGlzKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICQoJyNzZWFyY2gtc3VnZ2VzdGlvbicpLnRyaWdnZXIoJ2hpZGUnKTtcbiAgICAgICAgJHNlbGVjdFR5cGVDb250ZW50LnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTsgICAgICAgIFxuICAgIH0pO1xuICAgIFxuICAgICRzZWxlY3RUeXBlQ29udGVudC5vbignY2xpY2snLCAnbGknLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyICRzZWxmID0gJCh0aGlzKTtcbiAgICAgICAgJHNlbGVjdFR5cGVDb250ZW50LmZpbmQoJ2xpJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICRzZWxlY3RUeXBlQ29udGVudC5maW5kKCcjaGRmVHlwZScpLnZhbCgkc2VsZi5kYXRhKCd0eXBlJykpO1xuICAgICAgICAkc2VsZWN0VHlwZUNvbnRlbnQucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKCcuc2VsZWN0LWljb25zJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKCcjd29yZCcpLmF0dHIoJ3BsYWNlaG9sZGVyJywgJHNlbGYudGV4dCgpKS52YWwoJycpLmRhdGEoJ3dvcmQnLCAnJykuZm9jdXMoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2xpY2tPbldpbmRvdygpIHsgIFxuICAgIGlmKC9pUC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcbiAgICAgICAgJCgnKjpub3QoXCJhXCIpJykuY3NzKCdjdXJzb3InLCAncG9pbnRlcicpO1xuICAgIH07XG4gICAgXG4gICAgJChkb2N1bWVudCkuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgICQoJyNzZWFyY2gtc3VnZ2VzdGlvbicpLnRyaWdnZXIoJ2hpZGUnKTtcbiAgICAgICAgJCgnLnNlbGVjdC10eXBlcy1jb250ZW50JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAkKCcuc2VsZWN0LWljb25zJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVLZXlEb3duKCkge1xuICAgIGlmKHV0aWwuaXNNb2JpbGUoKSkgeyBcbiAgICAgICAgY29uc29sZS5sb2coJ2hhbmRsZUtleURvd24gOiBpc01vYmlsZScpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIHZhciAkc2VhcmNoU3VnZ2VzdGlvbiA9ICQoJyNzZWFyY2gtc3VnZ2VzdGlvbicpO1xuICAgIHZhciAkaW51dFdvcmQgPSAkKCcjd29yZCcpOyAgICBcbiAgICAkaW51dFdvcmQub24oJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7ICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgIGlmKCRzZWFyY2hTdWdnZXN0aW9uLmNzcygnZGlzcGxheScpID09PSAnbm9uZScpIHJldHVybjsgICAgICAgIFxuXG4gICAgICAgIHZhciBvcmlnaW5JbnB1dFZhbHVlID0gJGludXRXb3JkLmRhdGEoJ3dvcmQnKTtcblxuICAgICAgICBpZihlLmtleUNvZGUgPT09IDI3KSB7IC8vZXNjIFxuICAgICAgICAgICAgICRzZWFyY2hTdWdnZXN0aW9uLmhpZGUoKS5lbXB0eSgpO1xuICAgICAgICAgICAgICRpbnV0V29yZC52YWwob3JpZ2luSW5wdXRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmKGUua2V5Q29kZSA9PT0gMzgpIHsgLy91cFxuICAgICAgICAgICAgdmFyICRwcmV2ID0gJHNlYXJjaFN1Z2dlc3Rpb24uZmluZCgnbGkuYWN0aXZlJykucHJldigpO1xuICAgICAgICAgICAgJHNlYXJjaFN1Z2dlc3Rpb24uZmluZCgnbGkuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgaWYoJHByZXYubGVuZ3RoID4gMCkgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAkcHJldi5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgJGludXRXb3JkLnZhbCgkcHJldi5maW5kKCcubmFtZScpLnRleHQoKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRpbnV0V29yZC52YWwob3JpZ2luSW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0gZWxzZSBpZihlLmtleUNvZGUgPT09IDQwKSB7IC8vZG93blxuICAgICAgICAgICAgaWYoJHNlYXJjaFN1Z2dlc3Rpb24uZmluZCgnbGkuYWN0aXZlJykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAkc2VhcmNoU3VnZ2VzdGlvbi5maW5kKCdsaTpub3QoOmxhc3QtY2hpbGQpLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5uZXh0KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpOyAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzZWFyY2hTdWdnZXN0aW9uLmZpbmQoJ2xpOmZpcnN0JykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJGludXRXb3JkLnZhbCgkc2VhcmNoU3VnZ2VzdGlvbi5maW5kKCdsaS5hY3RpdmU6Zmlyc3QnKS5maW5kKCcubmFtZScpLnRleHQoKSk7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyICRjdXJyZW50SXRlbSA9ICRzZWFyY2hTdWdnZXN0aW9uLmZpbmQoJ2xpLmFjdGl2ZTpmaXJzdCcpO1xuICAgICAgICBpZigkY3VycmVudEl0ZW0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgJHNlYXJjaFN1Z2dlc3Rpb24uc2Nyb2xsVG9wKDApOyAgICAgICAgICAgIFxuICAgICAgICAgICAgJHNlYXJjaFN1Z2dlc3Rpb24uc2Nyb2xsVG9wKCgkY3VycmVudEl0ZW0ucG9zaXRpb24oKS50b3AgLSAkc2VhcmNoU3VnZ2VzdGlvbi5oZWlnaHQoKSkgKyAkY3VycmVudEl0ZW0uaGVpZ2h0KCkpOyAgICAgICAgICAgIFxuICAgICAgICB9ICAgICAgICBcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaW5pdCgpIHsgICAgXG4gICAgJCgnI2hvbWUtcGFnZSAjd29yZCcpLmZvY3VzKCk7XG4gICAgaW5pdHBhZ2UoKTtcbiAgICBzZWFyY2hBdXRvY29tcGxldGUoKTtcbiAgICBzdWJtaXRGb3JtKCk7XG4gICAgc2VsZWN0U2VhcmNoVHlwZSgpO1xuICAgIGhhbmRsZUNsaWNrT25XaW5kb3coKTsgICAgXG4gICAgaGFuZGxlS2V5RG93bigpO1xuICAgIHNob3dIaWRlU2VhcmNoU3VnZ2VzdGlvbigpO1xuICAgIC8vaW5wdXRGb2N1c091dCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBpbml0OiBpbml0XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIHV0aWwgPSByZXF1aXJlKCcuLi9oZWxwZXJzL3V0aWwnKTtcblxuZnVuY3Rpb24gaGFuZGxlV2luZG93U2Nyb2xsKCkge1xuICAgIHZhciAkd2luZG93ID0gJCh3aW5kb3cpO1xuICAgICR3aW5kb3cuc2Nyb2xsKGZ1bmN0aW9uKCkgeyAgICAgICAgXG4gICAgICAgIHZhciAkd2luZG93ID0gJCh3aW5kb3cpO1xuICAgICAgICBpZigkd2luZG93LndpZHRoKCkgPCAxMDI0IHx8IHV0aWwuaXNNb2JpbGUoKSkgcmV0dXJuO1xuXG4gICAgICAgIGlmKCR3aW5kb3cuc2Nyb2xsVG9wKCkgPj0gMzAwKSB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgJCgnLnNlYXJjaC1zZWN0aW9uJykuYWRkQ2xhc3MoJ2ZpeC10b3AnKS5jc3Moeyd6LWluZGV4JzogJzk5OTk5J30pO1xuICAgICAgICAgICAgJCgnLmFib3V0LXNlY3Rpb24nKS5jc3MoeydtYXJnaW4tdG9wJzogJzMwMHB4J30pO1xuICAgICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICQoJy5zZWFyY2gtc2VjdGlvbicpLnJlbW92ZUNsYXNzKCdmaXgtdG9wJykuY3NzKHsnei1pbmRleCc6ICcxJ30pOyAgICAgICAgICAgICAgXG4gICAgICAgICAgICAkKCcuYWJvdXQtc2VjdGlvbicpLmNzcyh7J21hcmdpbi10b3AnOiAnMHB4J30pO1xuICAgICAgICB9ICBcbiAgICB9KTtcbn1cblxuXG5mdW5jdGlvbiBpbml0KCkge1xuICAgIGhhbmRsZVdpbmRvd1Njcm9sbCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBpbml0OiBpbml0XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiByZXNldE5vdGljZSgpIHtcbiAgICB2YXIgJG5vdGljZSA9ICQoJyNub3RpY2UnKTtcbiAgICAkbm90aWNlLmZpbmQoJy5jb3JyZWN0JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkbm90aWNlLmZpbmQoJy5pbmNvcnJlY3QnKS5hZGRDbGFzcygnaGlkZScpLnRleHQoJycpO1xuICAgICRub3RpY2UuZmluZCgnLmJ0bi1pZ25vcmUnKS5zaG93KCk7XG4gICAgJCgnLmJ0bi1jaGVjaycpLnRleHQoJ0NoZWNrJyk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrKCkge1xuICAgIHZhciBhcnJRdWVzdGlvbnMgPSAkKCcucXVlc3Rpb24tY29udGFpbmVyJykudG9BcnJheSgpLCBxSW5kZXggPSAxO1xuICAgICQoJy5idG4tY2hlY2snKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciAkc2VsZiA9ICQodGhpcyksXG4gICAgICAgICAgICAkcXVlc3Rpb25Db250YWluZXIgPSAkc2VsZi5wYXJlbnRzKCcucXVlc3Rpb24tY29udGFpbmVyJyksICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICRoZGZBbnN3ZXIgPSAkcXVlc3Rpb25Db250YWluZXIuZmluZCgnLmhkZkFuc3dlcicpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhhcnJRdWVzdGlvbnMpO1xuXG4gICAgICAgIGlmICgkc2VsZi50ZXh0KCkgPT09ICdDaGVjaycpIHtcbiAgICAgICAgICAgIHZhciB1c2VyQW5zd2VyID0gJyc7XG4gICAgICAgICAgICAvLyBnZXQgdXNlckFuc3dlclxuICAgICAgICAgICAgaWYoJHF1ZXN0aW9uQ29udGFpbmVyLmRhdGEoJ3R5cGUnKSA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHVzZXJBbnN3ZXIgPSAkcXVlc3Rpb25Db250YWluZXIuZmluZCgnaW5wdXRbdHlwZT1yYWRpb106Y2hlY2tlZCcpLnZhbCgpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoJHF1ZXN0aW9uQ29udGFpbmVyLmRhdGEoJ3R5cGUnKSA9PT0gMiB8fCAkcXVlc3Rpb25Db250YWluZXIuZGF0YSgndHlwZScpID09PSAzIHx8ICRxdWVzdGlvbkNvbnRhaW5lci5kYXRhKCd0eXBlJykgPT09IDQpIHtcbiAgICAgICAgICAgICAgICB1c2VyQW5zd2VyID0gJHF1ZXN0aW9uQ29udGFpbmVyLmZpbmQoJy50eHQtYW5zd2VyJykudmFsKCkudHJpbSgpO1xuICAgICAgICAgICAgfSAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAvLyBhbnN3ZXJcbiAgICAgICAgICAgIHZhciBhbnN3ZXIgPSAkaGRmQW5zd2VyLnZhbCgpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodXNlckFuc3dlciA9PT0gYW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgJHF1ZXN0aW9uQ29udGFpbmVyLmFkZENsYXNzKCdwYXNzZWQnKTtcbiAgICAgICAgICAgICAgICAkKCcjbm90aWNlJykuZmluZCgnLmNvcnJlY3QnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgICAgICQoJyNub3RpY2UnKS5maW5kKCcuaW5jb3JyZWN0JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICAkKCcjbm90aWNlJykuZmluZCgnLmJ0bi1pZ25vcmUnKS5oaWRlKCk7XG4gICAgICAgICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAkKCcjbm90aWNlJykuZmluZCgnLmNvcnJlY3QnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgICAgICQoJyNub3RpY2UnKS5maW5kKCcuaW5jb3JyZWN0JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICAkKCcjbm90aWNlJykuZmluZCgnLmluY29ycmVjdCcpLnRleHQoJ0NvcnJlY3QgaXMgOiAnICsgJHF1ZXN0aW9uQ29udGFpbmVyLmZpbmQoJy5oZGZBbnN3ZXInKS52YWwoKSk7XG4gICAgICAgICAgICAgICAgJCgnI25vdGljZScpLmZpbmQoJy5idG4taWdub3JlJykuaGlkZSgpO1xuICAgICAgICAgICAgfSAgICAgICAgICBcblxuICAgICAgICAgICAgJHNlbGYudGV4dCgnQ29udGludWUnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRxdWVzdGlvbkNvbnRhaW5lci5mYWRlT3V0KDUwMCwgZnVuY3Rpb24gKCkgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXNldE5vdGljZSgpO1xuICAgICAgICAgICAgICAgIGlmKGFyclF1ZXN0aW9ucy5sZW5ndGggPiBxSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgJChhcnJRdWVzdGlvbnNbcUluZGV4XSkuZmFkZUluKDUwMCk7XG4gICAgICAgICAgICAgICAgICAgIHFJbmRleCsrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKCQoJy5xdWVzdGlvbi1jb250YWluZXI6bm90KC5wYXNzZWQpJykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJyUXVlc3Rpb25zID0gJCgnLnF1ZXN0aW9uLWNvbnRhaW5lcjpub3QoLnBhc3NlZCknKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBxSW5kZXggPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5xdWVzdGlvbi1jb250YWluZXI6bm90KC5wYXNzZWQpOmZpcnN0JykuZmFkZUluKDUwMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjZmluaXNoJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gcGxheVNvdW5kKCkgeyBcbiAgICAkKCcuc291bmQnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIGF1ZGlvID0gbmV3IEF1ZGlvKCQodGhpcykuZGF0YSgnc3JjJykpO1xuICAgICAgICBhdWRpby5wbGF5KCk7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBjaGVjaygpO1xuICAgIHBsYXlTb3VuZCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBpbml0OiBpbml0XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdXRpbCcpLFxuICAgIGFqYXggPSByZXF1aXJlKCcuLi9oZWxwZXJzL2FqYXgnKTtcblxuZnVuY3Rpb24gaW5pdFBhZ2UoKSB7XG4gICAgdmFyICRtb3JlRXhhbXBsZXMgPSAkKCcubW9yZS1leGFtcGxlcycpO1xuICAgICRtb3JlRXhhbXBsZXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYoJCh0aGlzKS5maW5kKCcuZXgnKS5sZW5ndGggPT09IDApICQodGhpcykucmVtb3ZlKCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIG9wZW5BZGRXb3JkUG9wdXAoKSB7XG4gICAgJCgnI2FkZFRvTGlzdCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZighdXRpbC5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICAgICAgJC5tYWduaWZpY1BvcHVwLm9wZW4oe1xuICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNyYzogJy5hdXRoZW4tcG9wdXAnICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQubWFnbmlmaWNQb3B1cC5vcGVuKHtcbiAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICBzcmM6ICcuYWRkLXRvLWxpc3QtcG9wdXAnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjYWxsYmFja3M6IHtcbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlT3BlbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWpheC5nZXQoJy9hcGkvbGlzdHMnKS5kb25lKGZ1bmN0aW9uKGxpc3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGxpc3RzLCBmdW5jdGlvbihpbmRleCwgbGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zICs9ICc8b3B0aW9uIHZhbHVlPVwiJyArIGxpc3QuX2lkICsgJ1wiPicgKyBsaXN0LnRpdGxlICsgJzwvb3B0aW9uPic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLmFkZC10by1saXN0LXBvcHVwICNsaXN0JykuZW1wdHkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuYWRkLXRvLWxpc3QtcG9wdXAgI2xpc3QnKS5hcHBlbmQob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGFkZFdvcmRUb0xpc3QoKSB7XG4gICAgdmFyICRhZGRUb0xpc3RQb3B1cCA9ICQoJyNhZGQtdG8tbGlzdC1wb3B1cCcpO1xuICAgICRhZGRUb0xpc3RQb3B1cC5vbignY2xpY2snLCAnYnV0dG9uJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgd29yZDogJGFkZFRvTGlzdFBvcHVwLmZpbmQoJy5oZXJvLXRpdGxlJykudGV4dCgpLFxuICAgICAgICAgICAgdHJhbnNsYXRlVG9FbjogJycsXG4gICAgICAgICAgICB0cmFuc2xhdGVUb1ZpOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGVudF9zZWxlY3RhYmxlJykub3V0ZXJIVE1MLFxuICAgICAgICAgICAgbGlzdElkOiAkYWRkVG9MaXN0UG9wdXAuZmluZCgnI2xpc3QnKS52YWwoKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy9hcGkvd29yZHMnLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KVxufVxuXG5mdW5jdGlvbiBzZWxlY3REaWN0VHlwZSgpIHtcbiAgICAkKCcuc2VsZWN0LWRpY3QtdHlwZSBsaSwgLm1lbnUtZGljdC10eXBlIGxpJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9kZWZpbml0aW9uLycgKyAkKHRoaXMpLmRhdGEoJ3R5cGUnKSArICcvJyArICQoJy53b3JkLW5hbWUnKS50ZXh0KCkudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGV4cGFuZENvbGxhcHNlVHlwZU9mV29yZCgpIHtcbiAgICAkKCcudHlwZS1vZi13b3JkJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICQodGhpcykuc2libGluZ3MoJy5sMS1ncm91cCcpLnNsaWRlVG9nZ2xlKCk7XG4gICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGV4cGFuZENvbGxhcHNlTW9yZUV4YW1wbGVzKCkge1xuICAgICQoJy5idG4tbW9yZS1leGcnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgJCh0aGlzKS5zaWJsaW5ncygnLmV4ZycpLnNsaWRlVG9nZ2xlKCk7XG4gICAgICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgaW5pdFBhZ2UoKTtcbiAgICBzZWxlY3REaWN0VHlwZSgpO1xuICAgIGV4cGFuZENvbGxhcHNlVHlwZU9mV29yZCgpO1xuICAgIGV4cGFuZENvbGxhcHNlTW9yZUV4YW1wbGVzKCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGluaXQ6IGluaXRcbn0iLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIHN1Ym1pdCgpIHtcbiAgICAkKCcjYnRuLXN1Ym1pdCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zb2xlLmxvZygnY3Jhd2xlcicpO1xuICAgICAgICB2YXIgcG9zdERhdGEgPSB7XG4gICAgICAgICAgICB1cmw6ICQoJyN1cmwnKS52YWwoKSxcbiAgICAgICAgICAgIGZyb21pbmRleDogJCgnI2Zyb21pbmRleCcpLnZhbCgpLFxuICAgICAgICAgICAgdG9pbmRleDogJCgnI3RvaW5kZXgnKS52YWwoKVxuICAgICAgICB9OyAgICAgICAgXG5cbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy9hcGkvd29yZGNyYXdsZXInLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBkYXRhOiBwb3N0RGF0YSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICQoJyNtc2cnKS50ZXh0KHJlc3VsdCkucmVtb3ZlQ2xhc3MoJ2hpZGUnKTsgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgJCgnI21zZycpLnRleHQoZXJyb3IpLnJlbW92ZUNsYXNzKCdoaWRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pOyAgICBcbn1cblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBzdWJtaXQoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgaW5pdDogaW5pdFxufSJdfQ=="}