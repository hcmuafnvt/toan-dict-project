{"version":3,"sources":["node_modules/browser-pack/_prelude.js","public/js/app.js","public/js/helpers/ajax.js","public/js/helpers/ajaxspiner.js","public/js/helpers/util.js","public/js/modules/header.js","public/js/modules/search.js","public/js/pages/home.page.js","public/js/pages/learn.page.js","public/js/pages/searchresult.page.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nvar header = require('./modules/header'),    \n    util = require('./helpers/util');\n\nvar pages = {\n    homepage: require('./pages/home.page'),\n    searchresultpage: require('./pages/searchresult.page'),\n    learnpage: require('./pages/learn.page')\n}\n\nfunction loadJavascriptForPage() {\n    if(typeof window.pageContext === 'undefined' || typeof window.pageContext.pageName === 'undefined') {\n        return;\n    }\n\n    if(typeof pages[window.pageContext.pageName] !== 'undefined') {\n        pages[window.pageContext.pageName].init();\n    }    \n}\n\nvar app = {\n    init: function() {    \n        header.init();\n        loadJavascriptForPage()\n    }\n};\n\n$(function() {\n    app.init();    \n});","'use strict';\n\nvar ajaxspiner = require('./ajaxspiner'),\n    util = require('./util'),\n    ajax = {};\n\n// function addAccessTokenToAjaxHeader(self, xhr) {\n//     if (window.user.userId !== 0) {\n//         if (typeof window.expat.access_token === 'undefined') {\n//             self.getAccessToken();\n//             if (typeof window.expat.access_token === 'undefined') {\n//                 xhr.abort();\n//             } else {\n//                 xhr.setRequestHeader(\"Authorization\", \"Bearer \" + window.expat.access_token);\n//             }\n//         } else {\n//             xhr.setRequestHeader(\"Authorization\", \"Bearer \" + window.expat.access_token);\n//         }\n//     }\n// }\n\najax.get = function (url, options) {    \n    var deferred = $.Deferred();\n    var ajaxSpinnerInstance;\n    var opts = $.extend({}, options);    \n\n    $.ajax({\n        method: 'GET',\n        url: url,\n        contentType: 'application/json',\n        beforeSend: function (xhr) {\n            // if (opts.isDisplaySpinner !== false) {\n            //     ajaxSpinnerInstance = new AjaxSpinner(opts.spinnerSize, opts.spinnerContainer, opts.isSpinnerLoadingText, opts.isOverlayDiv);\n            //     ajaxSpinnerInstance.startSpinner();\n            // }\n\n            //addAccessTokenToAjaxHeader(self, xhr);\n        },\n        success: function (data) {\n            deferred.resolve(data);\n        },\n        error: function (error) {            \n            deferred.reject(error);\n        },\n        complete: function () {\n            // if (opts.isDisplaySpinner !== true) {\n            //     ajaxSpinnerInstance.stopSpinner();\n            // }\n        }\n    });\n\n    return deferred.promise();\n};\n\n// ajax.delete = function (url, options) {    \n//     var deferred = $.Deferred();\n//     var ajaxSpinnerInstance;\n//     var opts = $.extend({}, options);\n    \n//     $.ajax({\n//         method: 'DELETE',\n//         url: url,\n//         contentType: 'application/json',\n//         beforeSend: function (xhr) {\n//             if (typeof opts.isDisplaySpinner === 'undefined' || opts.isDisplaySpinner === true) {\n//                 ajaxSpinnerInstance = new AjaxSpinner(opts.spinnerSize, opts.spinnerContainer, opts.isSpinnerLoadingText, opts.isOverlayDiv);\n//                 ajaxSpinnerInstance.startSpinner();\n//             }\n\n//             if (url.indexOf('/api/') !== -1) {\n//                 addAccessTokenToAjaxHeader(self, xhr);\n//             }\n//         },\n//         success: function (data) {\n//             deferred.resolve(data);\n//         },\n//         error: function (error) {\n//             window.expat.access_token = undefined;\n//             deferred.reject(error);\n//         },\n//         complete: function () {\n//             if (typeof opts.isDisplaySpinner === 'undefined' || opts.isDisplaySpinner === true) {\n//                 ajaxSpinnerInstance.stopSpinner();\n//             }\n//         }\n//     });\n\n//     return deferred.promise();\n// };\n\n// /*\n//  * - url : api url\n//  * - options\n//  *  + spinnerSize : spinner size (small, medium, large), default is large\n//  *  + spinnerContainer : container to append spinner and overlay, default is body\n//  *  + spinnerContainer : By default, spinner is showed. Set value to false to hide spinner\n//  *  + isSpinnerLoadingText : used to add \"Loading ...\" text under spinner icon\n//  *  + isOverlayDiv : for display overlay div, default is true\n//  * - postData : api post data\n//  */\n// BaseClass.prototype.sendPost = function (url, options, postData) {\n//     var self = this;\n//     var deferred = $.Deferred();\n//     var ajaxSpinnerInstance;\n//     var opts = $.extend({}, options);\n//     postData = $.extend({ LoginUserId: expat.user.userId }, postData);\n\n//     var contentType = typeof opts.contentType !== 'undefined' ? opts.contentType : 'application/x-www-form-urlencoded; charset=UTF-8';\n//     if (opts.isStringify) {\n//         postData = JSON.stringify(postData);\n//     }\n\n//     if (url.indexOf('/api/') !== -1) {\n//         contentType = 'application/json';\n//         postData = JSON.stringify(postData);\n//     }\n//     var ajaxOptions = {\n//         method: 'POST',\n//         url: url,\n//         data: postData,\n//         contentType: contentType,\n//         //dataType: 'json',\n//         beforeSend: function (xhr) {\n//             if (typeof opts.isDisplaySpinner === 'undefined' || opts.isDisplaySpinner === true) {\n//                 ajaxSpinnerInstance = new AjaxSpinner(opts.spinnerSize, opts.spinnerContainer, opts.isSpinnerLoadingText, opts.isOverlayDiv);\n//                 ajaxSpinnerInstance.startSpinner();\n//             }\n\n//             if (url.indexOf('/api/') !== -1) {\n//                 addAccessTokenToAjaxHeader(self, xhr);\n//             }\n//         },\n//         success: function (data) {\n//             deferred.resolve(data);\n//         },\n//         error: function (error) {\n//             window.expat.access_token = undefined;\n//             deferred.reject(error);\n//         },\n//         complete: function () {\n//             if (typeof opts.isDisplaySpinner === 'undefined' || opts.isDisplaySpinner === true) {\n//                 ajaxSpinnerInstance.stopSpinner();\n//             }\n//         }\n//     };\n\n//     $.ajax(ajaxOptions);\n\n//     return deferred.promise();\n// };\n\n// /*\n//  * - url : jquery template url\n//  * - tmplId : template id\n//  * - tmplData : data to bind into template\n//  */\n// BaseClass.prototype.generateTmpl = function (url, tmplId, tmplData) {\n//     var baseClass = this;\n//     var deferred = $.Deferred();\n\n//     var $tmplId = $(tmplId);\n//     if ($tmplId.length) {\n//         deferred.resolve(bindTmpl($tmplId, tmplData));\n//     }\n//     else {\n//         baseClass.sendGet(url, { isDisplaySpinner: false }).done(function (template) {\n//             $('body').append(template);\n//             deferred.resolve(bindTmpl($(tmplId), tmplData));\n//         }).fail(function (error) {\n//             deferred.reject(error);\n//         });\n//     }\n\n//     return deferred;\n// };\n\n// //========================================\n// // Private functions\n\n// function bindTmpl($tmplId, tmplData) {\n//     $.template($tmplId.attr('id'), $tmplId);\n//     if (typeof tmplData !== 'undefined') {\n//         return $.tmpl($tmplId.attr('id'), tmplData);\n//     }\n//     return $.tmpl($tmplId.attr('id'));\n// }\n\n\nmodule.exports = ajax;","'use strict';\n\nvar ajaxspiner = {},\n    spinner,\n    spinnerContainer,\n    defaultOpts = {\n        lines: 11, // The number of lines to draw\n        length: 15, // The length of each line\n        width: 6, // The line thickness\n        radius: 15, // The radius of the inner circle\n        scale: 1, // Scales overall size of the spinner\n        corners: 0.8, // Corner roundness (0..1)\n        color: '#00C3FF', // #rgb or #rrggbb or array of colors\n        opacity: 0.15, // Opacity of the lines\n        rotate: 0, // The rotation offset\n        direction: 1, // 1: clockwise, -1: counterclockwise\n        speed: 1, // Rounds per second\n        trail: 60, // Afterglow percentage\n        fps: 20, // Frames per second when using setTimeout() as a fallback for CSS\n        zIndex: 2e9, // The z-index (defaults to 2000000000)\n        className: 'spinner', // The CSS class to assign to the spinner\n        top: '50%', // Top position relative to parent\n        left: '50%', // Left position relative to parent\n        shadow: false, // Whether to render a shadow\n        hwaccel: false, // Whether to use hardware acceleration\n        position: 'absolute' // Element positioning\n    };\n\najaxspiner.start = function (options) {\n    options = options || {};\n    spinnerContainer = options.spinnerContainer || 'body';\n    var spinnerSize = options.spinnerSize || 'large',\n        isSpinnerLoadingText = options.isSpinnerLoadingText || false,\n        isOverlayDiv = typeof options.isOverlayDiv !== 'undefined' ? options.isOverlayDiv : true,\n        opts;\n\n    switch (spinnerSize) {\n        case 'small':\n            opts = $.extend(defaultOpts, { lines: 11, length: 8, width: 3, radius: 6 });\n            break;\n        case 'medium':\n            opts = $.extend(defaultOpts, { lines: 11, length: 10, width: 5, radius: 11 });\n            break;\n        default: //large size for page\n            opts = defaultOpts;\n            break;\n    }\n    //var baseClass = this;\n    var target = document.querySelector(spinnerContainer);\n\n    //check and add \"position: relative\" for spinner container\n    if (target.style.position !== 'absolute' || target.style.position !== 'relative') {\n        target.style.position = 'relative';\n    }\n\n    //add ajax overlay div\n    if (isOverlayDiv !== false) {\n        var overlayDiv = document.createElement('div');\n        overlayDiv.classList.add('ajax-overlay');\n        target.appendChild(overlayDiv);\n    }\n\n    spinner = new Spinner(opts).spin(target);\n    if (typeof isSpinnerLoadingText !== 'undefined' && isSpinnerLoadingText === true) {\n        var spinnerLoadingTextDiv = document.createElement('div');\n        var textNote = document.createTextNode('Loading more ...');\n        spinnerLoadingTextDiv.appendChild(textNote);\n        spinnerLoadingTextDiv.classList.add('spinnerLoadingText');        \n        spinnerLoadingTextDiv.classList.add(spinnerSize);\n        spinner.el.appendChild(spinnerLoadingTextDiv);\n    }\n};\n\najaxspiner.stop = function () {\n    spinner.stop();\n    $(spinnerContainer).find('.ajax-overlay').remove();\n};\n\nmodule.exports = ajaxspiner;","'use strict';\n\nvar ajaxspiner = require('./ajaxspiner');\n\nfunction isAuthenticated() {\n    if(typeof userId !== 'undefined' && userId !== '')\n        return true;\n    return false;\n}\n\nfunction openAjaxPopup(url, popupSelector) {    \n    $.magnificPopup.open({\n        items: {\n            src: popupSelector\n        },\n        callbacks: {\n            beforeOpen: function() {\n                ajaxspiner.start({\n                    spinnerContainer: popupSelector\n                });\n            }\n        }\n    });\n}\n\nvar util = {\n    isAuthenticated: isAuthenticated,\n    openAjaxPopup: openAjaxPopup\n};\n\nmodule.exports = util;","'use strict';\n\nvar search = require('./search');\n\nfunction toggleMenu() {\n    $('.toggle-menu').on('click', function (e) {\n        e.preventDefault();\n        $('body').toggleClass('mobile-menu');\n    })\n}\n\nfunction init() {\n    toggleMenu();\n    search.init();\n}\n\nmodule.exports = {\n    init: init\n}","'use strict';\n\nfunction bindAutoComplete(data) {\n    var $searchSuggestion = $('#search-suggestion');    \n    $searchSuggestion.empty(); \n\n    if(data == null) {\n        return;\n    }\n\n    var len = data.suggestions.length;\n    var result = '<ul>';    \n    $.each(data.suggestions, function(index, item) {        \n        result += '<li><a href=\"/search?word=' + item.select + '&type=vi\">' + $(item.data).html() + '</a></li>';\n    });\n    $searchSuggestion.append(result + '</ul>');\n}\n\nfunction searchAutocomplete() {\n    $(\"#word\").on('input', function() {\n        var $self = $(this);\n        var word = $self.val().trim();\n        if(word === '') {\n            bindAutoComplete(null);\n            return;\n        } \n\n        $.ajax({\n            url: \"/api/vidict/autocomplete/\" + $(this).val().trim(),              \n            method: \"GET\",\n            dataType: \"json\",\n            success: function (data) {      \n                bindAutoComplete(data);\n            }\n        });     \n    });    \n}\n\nfunction init() {\n    searchAutocomplete();\n}\n\nmodule.exports = {\n    init: init\n};\n","'use strict';\n\nfunction init() {\n    console.log('Home Page');\n}\n\nmodule.exports = {\n    init: init\n}","'use strict';\n\nfunction resetNotice() {\n    var $notice = $('#notice');\n    $notice.find('.correct').addClass('hide');\n    $notice.find('.incorrect').addClass('hide').text('');\n    $notice.find('.btn-ignore').show();\n    $('.btn-check').text('Check');\n}\n\nfunction check() {\n    var arrQuestions = $('.question-container').toArray(), qIndex = 1;\n    $('.btn-check').on('click', function (e) {\n        e.preventDefault();\n        var $self = $(this),\n            $questionContainer = $self.parents('.question-container'),                       \n            $hdfAnswer = $questionContainer.find('.hdfAnswer');\n\n            console.log(arrQuestions);\n\n        if ($self.text() === 'Check') {\n            var userAnswer = '';\n            // get userAnswer\n            if($questionContainer.data('type') === 1) {\n                userAnswer = $questionContainer.find('input[type=radio]:checked').val().trim().toLowerCase();\n            }\n            if($questionContainer.data('type') === 2 || $questionContainer.data('type') === 3 || $questionContainer.data('type') === 4) {\n                userAnswer = $questionContainer.find('.txt-answer').val().trim();\n            }            \n\n            // answer\n            var answer = $hdfAnswer.val().trim().toLowerCase();\n            \n            if (userAnswer === answer) {\n                $questionContainer.addClass('passed');\n                $('#notice').find('.correct').removeClass('hide');\n                $('#notice').find('.incorrect').addClass('hide');\n                $('#notice').find('.btn-ignore').hide();\n            } else {                \n                $('#notice').find('.correct').addClass('hide');\n                $('#notice').find('.incorrect').removeClass('hide');\n                $('#notice').find('.incorrect').text('Correct is : ' + $questionContainer.find('.hdfAnswer').val());\n                $('#notice').find('.btn-ignore').hide();\n            }          \n\n            $self.text('Continue');\n        } else {\n            $questionContainer.fadeOut(500, function () {                \n                resetNotice();\n                if(arrQuestions.length > qIndex) {\n                    $(arrQuestions[qIndex]).fadeIn(500);\n                    qIndex++;\n                } else {\n                    if($('.question-container:not(.passed)').length > 0) {\n                        arrQuestions = $('.question-container:not(.passed)').toArray();\n                        qIndex = 1;\n                         $('.question-container:not(.passed):first').fadeIn(500);\n                    } else {\n                        $('#finish').removeClass('hide');\n                    }                        \n                }                             \n            });\n        }\n    });\n}\n\nfunction playSound() { \n    $('.sound').on('click', function(e) {\n        e.preventDefault();\n        var audio = new Audio($(this).data('src'));\n        audio.play();\n    })\n}\n\nfunction init() {\n    check();\n    playSound();\n}\n\nmodule.exports = {\n    init: init\n}","'use strict';\n\nvar util = require('../helpers/util'),\n    ajax = require('../helpers/ajax');\n\nfunction openAddWordPopup() {\n    $('#addToList').on('click', function(e) {\n        e.preventDefault();\n        if(!util.isAuthenticated()) {\n            $.magnificPopup.open({\n                items: {\n                    src: '.authen-popup'                    \n                }\n            });\n            return;\n        } else {\n            $.magnificPopup.open({\n                items: {\n                    src: '.add-to-list-popup'\n                },\n                callbacks: {\n                    beforeOpen: function() {\n                        var options = '';\n                        ajax.get('/api/lists').done(function(lists) {\n                            $.each(lists, function(index, list) {\n                                options += '<option value=\"' + list._id + '\">' + list.title + '</option>';\n                            });\n                            $('.add-to-list-popup #list').empty();\n                            $('.add-to-list-popup #list').append(options);\n                        }).fail(function(err) {\n                            console.log(err);\n                        });\n                    }\n                }\n            });\n        }\n    });\n}\n\nfunction addWordToList() {\n    var $addToListPopup = $('#add-to-list-popup');\n    $addToListPopup.on('click', 'button', function(e) {\n        e.preventDefault();\n        var data = {\n            word: $addToListPopup.find('.hero-title').text(),\n            translateToEn: '',\n            translateToVi: document.getElementById('content_selectable').outerHTML,\n            listId: $addToListPopup.find('#list').val()\n        }\n\n        console.log(data);\n\n        $.ajax({\n            url: '/api/words',\n            method: 'POST',\n            data: data,\n            success: function(result) {\n                console.log(result);\n            },\n            error: function(err) {\n                console.log(err);\n            }\n        })\n    })\n}\n\nfunction init() {\n    openAddWordPopup();\n    addWordToList();\n}\n\nmodule.exports = {\n    init: init\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwdWJsaWMvanMvYXBwLmpzIiwicHVibGljL2pzL2hlbHBlcnMvYWpheC5qcyIsInB1YmxpYy9qcy9oZWxwZXJzL2FqYXhzcGluZXIuanMiLCJwdWJsaWMvanMvaGVscGVycy91dGlsLmpzIiwicHVibGljL2pzL21vZHVsZXMvaGVhZGVyLmpzIiwicHVibGljL2pzL21vZHVsZXMvc2VhcmNoLmpzIiwicHVibGljL2pzL3BhZ2VzL2hvbWUucGFnZS5qcyIsInB1YmxpYy9qcy9wYWdlcy9sZWFybi5wYWdlLmpzIiwicHVibGljL2pzL3BhZ2VzL3NlYXJjaHJlc3VsdC5wYWdlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCc7XG5cbnZhciBoZWFkZXIgPSByZXF1aXJlKCcuL21vZHVsZXMvaGVhZGVyJyksICAgIFxuICAgIHV0aWwgPSByZXF1aXJlKCcuL2hlbHBlcnMvdXRpbCcpO1xuXG52YXIgcGFnZXMgPSB7XG4gICAgaG9tZXBhZ2U6IHJlcXVpcmUoJy4vcGFnZXMvaG9tZS5wYWdlJyksXG4gICAgc2VhcmNocmVzdWx0cGFnZTogcmVxdWlyZSgnLi9wYWdlcy9zZWFyY2hyZXN1bHQucGFnZScpLFxuICAgIGxlYXJucGFnZTogcmVxdWlyZSgnLi9wYWdlcy9sZWFybi5wYWdlJylcbn1cblxuZnVuY3Rpb24gbG9hZEphdmFzY3JpcHRGb3JQYWdlKCkge1xuICAgIGlmKHR5cGVvZiB3aW5kb3cucGFnZUNvbnRleHQgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiB3aW5kb3cucGFnZUNvbnRleHQucGFnZU5hbWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZih0eXBlb2YgcGFnZXNbd2luZG93LnBhZ2VDb250ZXh0LnBhZ2VOYW1lXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcGFnZXNbd2luZG93LnBhZ2VDb250ZXh0LnBhZ2VOYW1lXS5pbml0KCk7XG4gICAgfSAgICBcbn1cblxudmFyIGFwcCA9IHtcbiAgICBpbml0OiBmdW5jdGlvbigpIHsgICAgXG4gICAgICAgIGhlYWRlci5pbml0KCk7XG4gICAgICAgIGxvYWRKYXZhc2NyaXB0Rm9yUGFnZSgpXG4gICAgfVxufTtcblxuJChmdW5jdGlvbigpIHtcbiAgICBhcHAuaW5pdCgpOyAgICBcbn0pOyIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFqYXhzcGluZXIgPSByZXF1aXJlKCcuL2FqYXhzcGluZXInKSxcbiAgICB1dGlsID0gcmVxdWlyZSgnLi91dGlsJyksXG4gICAgYWpheCA9IHt9O1xuXG4vLyBmdW5jdGlvbiBhZGRBY2Nlc3NUb2tlblRvQWpheEhlYWRlcihzZWxmLCB4aHIpIHtcbi8vICAgICBpZiAod2luZG93LnVzZXIudXNlcklkICE9PSAwKSB7XG4vLyAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmV4cGF0LmFjY2Vzc190b2tlbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbi8vICAgICAgICAgICAgIHNlbGYuZ2V0QWNjZXNzVG9rZW4oKTtcbi8vICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmV4cGF0LmFjY2Vzc190b2tlbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbi8vICAgICAgICAgICAgICAgICB4aHIuYWJvcnQoKTtcbi8vICAgICAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJBdXRob3JpemF0aW9uXCIsIFwiQmVhcmVyIFwiICsgd2luZG93LmV4cGF0LmFjY2Vzc190b2tlbik7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkF1dGhvcml6YXRpb25cIiwgXCJCZWFyZXIgXCIgKyB3aW5kb3cuZXhwYXQuYWNjZXNzX3Rva2VuKTtcbi8vICAgICAgICAgfVxuLy8gICAgIH1cbi8vIH1cblxuYWpheC5nZXQgPSBmdW5jdGlvbiAodXJsLCBvcHRpb25zKSB7ICAgIFxuICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbiAgICB2YXIgYWpheFNwaW5uZXJJbnN0YW5jZTtcbiAgICB2YXIgb3B0cyA9ICQuZXh0ZW5kKHt9LCBvcHRpb25zKTsgICAgXG5cbiAgICAkLmFqYXgoe1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKHhocikge1xuICAgICAgICAgICAgLy8gaWYgKG9wdHMuaXNEaXNwbGF5U3Bpbm5lciAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIC8vICAgICBhamF4U3Bpbm5lckluc3RhbmNlID0gbmV3IEFqYXhTcGlubmVyKG9wdHMuc3Bpbm5lclNpemUsIG9wdHMuc3Bpbm5lckNvbnRhaW5lciwgb3B0cy5pc1NwaW5uZXJMb2FkaW5nVGV4dCwgb3B0cy5pc092ZXJsYXlEaXYpO1xuICAgICAgICAgICAgLy8gICAgIGFqYXhTcGlubmVySW5zdGFuY2Uuc3RhcnRTcGlubmVyKCk7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIC8vYWRkQWNjZXNzVG9rZW5Ub0FqYXhIZWFkZXIoc2VsZiwgeGhyKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGF0YSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHsgICAgICAgICAgICBcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlcnJvcik7XG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBpZiAob3B0cy5pc0Rpc3BsYXlTcGlubmVyICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAvLyAgICAgYWpheFNwaW5uZXJJbnN0YW5jZS5zdG9wU3Bpbm5lcigpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxuLy8gYWpheC5kZWxldGUgPSBmdW5jdGlvbiAodXJsLCBvcHRpb25zKSB7ICAgIFxuLy8gICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbi8vICAgICB2YXIgYWpheFNwaW5uZXJJbnN0YW5jZTtcbi8vICAgICB2YXIgb3B0cyA9ICQuZXh0ZW5kKHt9LCBvcHRpb25zKTtcbiAgICBcbi8vICAgICAkLmFqYXgoe1xuLy8gICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuLy8gICAgICAgICB1cmw6IHVybCxcbi8vICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbi8vICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKHhocikge1xuLy8gICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRzLmlzRGlzcGxheVNwaW5uZXIgPT09ICd1bmRlZmluZWQnIHx8IG9wdHMuaXNEaXNwbGF5U3Bpbm5lciA9PT0gdHJ1ZSkge1xuLy8gICAgICAgICAgICAgICAgIGFqYXhTcGlubmVySW5zdGFuY2UgPSBuZXcgQWpheFNwaW5uZXIob3B0cy5zcGlubmVyU2l6ZSwgb3B0cy5zcGlubmVyQ29udGFpbmVyLCBvcHRzLmlzU3Bpbm5lckxvYWRpbmdUZXh0LCBvcHRzLmlzT3ZlcmxheURpdik7XG4vLyAgICAgICAgICAgICAgICAgYWpheFNwaW5uZXJJbnN0YW5jZS5zdGFydFNwaW5uZXIoKTtcbi8vICAgICAgICAgICAgIH1cblxuLy8gICAgICAgICAgICAgaWYgKHVybC5pbmRleE9mKCcvYXBpLycpICE9PSAtMSkge1xuLy8gICAgICAgICAgICAgICAgIGFkZEFjY2Vzc1Rva2VuVG9BamF4SGVhZGVyKHNlbGYsIHhocik7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH0sXG4vLyAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4vLyAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpO1xuLy8gICAgICAgICB9LFxuLy8gICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4vLyAgICAgICAgICAgICB3aW5kb3cuZXhwYXQuYWNjZXNzX3Rva2VuID0gdW5kZWZpbmVkO1xuLy8gICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbi8vICAgICAgICAgfSxcbi8vICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbi8vICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0cy5pc0Rpc3BsYXlTcGlubmVyID09PSAndW5kZWZpbmVkJyB8fCBvcHRzLmlzRGlzcGxheVNwaW5uZXIgPT09IHRydWUpIHtcbi8vICAgICAgICAgICAgICAgICBhamF4U3Bpbm5lckluc3RhbmNlLnN0b3BTcGlubmVyKCk7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH1cbi8vICAgICB9KTtcblxuLy8gICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4vLyB9O1xuXG4vLyAvKlxuLy8gICogLSB1cmwgOiBhcGkgdXJsXG4vLyAgKiAtIG9wdGlvbnNcbi8vICAqICArIHNwaW5uZXJTaXplIDogc3Bpbm5lciBzaXplIChzbWFsbCwgbWVkaXVtLCBsYXJnZSksIGRlZmF1bHQgaXMgbGFyZ2Vcbi8vICAqICArIHNwaW5uZXJDb250YWluZXIgOiBjb250YWluZXIgdG8gYXBwZW5kIHNwaW5uZXIgYW5kIG92ZXJsYXksIGRlZmF1bHQgaXMgYm9keVxuLy8gICogICsgc3Bpbm5lckNvbnRhaW5lciA6IEJ5IGRlZmF1bHQsIHNwaW5uZXIgaXMgc2hvd2VkLiBTZXQgdmFsdWUgdG8gZmFsc2UgdG8gaGlkZSBzcGlubmVyXG4vLyAgKiAgKyBpc1NwaW5uZXJMb2FkaW5nVGV4dCA6IHVzZWQgdG8gYWRkIFwiTG9hZGluZyAuLi5cIiB0ZXh0IHVuZGVyIHNwaW5uZXIgaWNvblxuLy8gICogICsgaXNPdmVybGF5RGl2IDogZm9yIGRpc3BsYXkgb3ZlcmxheSBkaXYsIGRlZmF1bHQgaXMgdHJ1ZVxuLy8gICogLSBwb3N0RGF0YSA6IGFwaSBwb3N0IGRhdGFcbi8vICAqL1xuLy8gQmFzZUNsYXNzLnByb3RvdHlwZS5zZW5kUG9zdCA9IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMsIHBvc3REYXRhKSB7XG4vLyAgICAgdmFyIHNlbGYgPSB0aGlzO1xuLy8gICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcbi8vICAgICB2YXIgYWpheFNwaW5uZXJJbnN0YW5jZTtcbi8vICAgICB2YXIgb3B0cyA9ICQuZXh0ZW5kKHt9LCBvcHRpb25zKTtcbi8vICAgICBwb3N0RGF0YSA9ICQuZXh0ZW5kKHsgTG9naW5Vc2VySWQ6IGV4cGF0LnVzZXIudXNlcklkIH0sIHBvc3REYXRhKTtcblxuLy8gICAgIHZhciBjb250ZW50VHlwZSA9IHR5cGVvZiBvcHRzLmNvbnRlbnRUeXBlICE9PSAndW5kZWZpbmVkJyA/IG9wdHMuY29udGVudFR5cGUgOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04Jztcbi8vICAgICBpZiAob3B0cy5pc1N0cmluZ2lmeSkge1xuLy8gICAgICAgICBwb3N0RGF0YSA9IEpTT04uc3RyaW5naWZ5KHBvc3REYXRhKTtcbi8vICAgICB9XG5cbi8vICAgICBpZiAodXJsLmluZGV4T2YoJy9hcGkvJykgIT09IC0xKSB7XG4vLyAgICAgICAgIGNvbnRlbnRUeXBlID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuLy8gICAgICAgICBwb3N0RGF0YSA9IEpTT04uc3RyaW5naWZ5KHBvc3REYXRhKTtcbi8vICAgICB9XG4vLyAgICAgdmFyIGFqYXhPcHRpb25zID0ge1xuLy8gICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbi8vICAgICAgICAgdXJsOiB1cmwsXG4vLyAgICAgICAgIGRhdGE6IHBvc3REYXRhLFxuLy8gICAgICAgICBjb250ZW50VHlwZTogY29udGVudFR5cGUsXG4vLyAgICAgICAgIC8vZGF0YVR5cGU6ICdqc29uJyxcbi8vICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24gKHhocikge1xuLy8gICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRzLmlzRGlzcGxheVNwaW5uZXIgPT09ICd1bmRlZmluZWQnIHx8IG9wdHMuaXNEaXNwbGF5U3Bpbm5lciA9PT0gdHJ1ZSkge1xuLy8gICAgICAgICAgICAgICAgIGFqYXhTcGlubmVySW5zdGFuY2UgPSBuZXcgQWpheFNwaW5uZXIob3B0cy5zcGlubmVyU2l6ZSwgb3B0cy5zcGlubmVyQ29udGFpbmVyLCBvcHRzLmlzU3Bpbm5lckxvYWRpbmdUZXh0LCBvcHRzLmlzT3ZlcmxheURpdik7XG4vLyAgICAgICAgICAgICAgICAgYWpheFNwaW5uZXJJbnN0YW5jZS5zdGFydFNwaW5uZXIoKTtcbi8vICAgICAgICAgICAgIH1cblxuLy8gICAgICAgICAgICAgaWYgKHVybC5pbmRleE9mKCcvYXBpLycpICE9PSAtMSkge1xuLy8gICAgICAgICAgICAgICAgIGFkZEFjY2Vzc1Rva2VuVG9BamF4SGVhZGVyKHNlbGYsIHhocik7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH0sXG4vLyAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4vLyAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpO1xuLy8gICAgICAgICB9LFxuLy8gICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4vLyAgICAgICAgICAgICB3aW5kb3cuZXhwYXQuYWNjZXNzX3Rva2VuID0gdW5kZWZpbmVkO1xuLy8gICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbi8vICAgICAgICAgfSxcbi8vICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbi8vICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0cy5pc0Rpc3BsYXlTcGlubmVyID09PSAndW5kZWZpbmVkJyB8fCBvcHRzLmlzRGlzcGxheVNwaW5uZXIgPT09IHRydWUpIHtcbi8vICAgICAgICAgICAgICAgICBhamF4U3Bpbm5lckluc3RhbmNlLnN0b3BTcGlubmVyKCk7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgIH1cbi8vICAgICB9O1xuXG4vLyAgICAgJC5hamF4KGFqYXhPcHRpb25zKTtcblxuLy8gICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4vLyB9O1xuXG4vLyAvKlxuLy8gICogLSB1cmwgOiBqcXVlcnkgdGVtcGxhdGUgdXJsXG4vLyAgKiAtIHRtcGxJZCA6IHRlbXBsYXRlIGlkXG4vLyAgKiAtIHRtcGxEYXRhIDogZGF0YSB0byBiaW5kIGludG8gdGVtcGxhdGVcbi8vICAqL1xuLy8gQmFzZUNsYXNzLnByb3RvdHlwZS5nZW5lcmF0ZVRtcGwgPSBmdW5jdGlvbiAodXJsLCB0bXBsSWQsIHRtcGxEYXRhKSB7XG4vLyAgICAgdmFyIGJhc2VDbGFzcyA9IHRoaXM7XG4vLyAgICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xuXG4vLyAgICAgdmFyICR0bXBsSWQgPSAkKHRtcGxJZCk7XG4vLyAgICAgaWYgKCR0bXBsSWQubGVuZ3RoKSB7XG4vLyAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoYmluZFRtcGwoJHRtcGxJZCwgdG1wbERhdGEpKTtcbi8vICAgICB9XG4vLyAgICAgZWxzZSB7XG4vLyAgICAgICAgIGJhc2VDbGFzcy5zZW5kR2V0KHVybCwgeyBpc0Rpc3BsYXlTcGlubmVyOiBmYWxzZSB9KS5kb25lKGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xuLy8gICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCh0ZW1wbGF0ZSk7XG4vLyAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGJpbmRUbXBsKCQodG1wbElkKSwgdG1wbERhdGEpKTtcbi8vICAgICAgICAgfSkuZmFpbChmdW5jdGlvbiAoZXJyb3IpIHtcbi8vICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlcnJvcik7XG4vLyAgICAgICAgIH0pO1xuLy8gICAgIH1cblxuLy8gICAgIHJldHVybiBkZWZlcnJlZDtcbi8vIH07XG5cbi8vIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gLy8gUHJpdmF0ZSBmdW5jdGlvbnNcblxuLy8gZnVuY3Rpb24gYmluZFRtcGwoJHRtcGxJZCwgdG1wbERhdGEpIHtcbi8vICAgICAkLnRlbXBsYXRlKCR0bXBsSWQuYXR0cignaWQnKSwgJHRtcGxJZCk7XG4vLyAgICAgaWYgKHR5cGVvZiB0bXBsRGF0YSAhPT0gJ3VuZGVmaW5lZCcpIHtcbi8vICAgICAgICAgcmV0dXJuICQudG1wbCgkdG1wbElkLmF0dHIoJ2lkJyksIHRtcGxEYXRhKTtcbi8vICAgICB9XG4vLyAgICAgcmV0dXJuICQudG1wbCgkdG1wbElkLmF0dHIoJ2lkJykpO1xuLy8gfVxuXG5cbm1vZHVsZS5leHBvcnRzID0gYWpheDsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBhamF4c3BpbmVyID0ge30sXG4gICAgc3Bpbm5lcixcbiAgICBzcGlubmVyQ29udGFpbmVyLFxuICAgIGRlZmF1bHRPcHRzID0ge1xuICAgICAgICBsaW5lczogMTEsIC8vIFRoZSBudW1iZXIgb2YgbGluZXMgdG8gZHJhd1xuICAgICAgICBsZW5ndGg6IDE1LCAvLyBUaGUgbGVuZ3RoIG9mIGVhY2ggbGluZVxuICAgICAgICB3aWR0aDogNiwgLy8gVGhlIGxpbmUgdGhpY2tuZXNzXG4gICAgICAgIHJhZGl1czogMTUsIC8vIFRoZSByYWRpdXMgb2YgdGhlIGlubmVyIGNpcmNsZVxuICAgICAgICBzY2FsZTogMSwgLy8gU2NhbGVzIG92ZXJhbGwgc2l6ZSBvZiB0aGUgc3Bpbm5lclxuICAgICAgICBjb3JuZXJzOiAwLjgsIC8vIENvcm5lciByb3VuZG5lc3MgKDAuLjEpXG4gICAgICAgIGNvbG9yOiAnIzAwQzNGRicsIC8vICNyZ2Igb3IgI3JyZ2diYiBvciBhcnJheSBvZiBjb2xvcnNcbiAgICAgICAgb3BhY2l0eTogMC4xNSwgLy8gT3BhY2l0eSBvZiB0aGUgbGluZXNcbiAgICAgICAgcm90YXRlOiAwLCAvLyBUaGUgcm90YXRpb24gb2Zmc2V0XG4gICAgICAgIGRpcmVjdGlvbjogMSwgLy8gMTogY2xvY2t3aXNlLCAtMTogY291bnRlcmNsb2Nrd2lzZVxuICAgICAgICBzcGVlZDogMSwgLy8gUm91bmRzIHBlciBzZWNvbmRcbiAgICAgICAgdHJhaWw6IDYwLCAvLyBBZnRlcmdsb3cgcGVyY2VudGFnZVxuICAgICAgICBmcHM6IDIwLCAvLyBGcmFtZXMgcGVyIHNlY29uZCB3aGVuIHVzaW5nIHNldFRpbWVvdXQoKSBhcyBhIGZhbGxiYWNrIGZvciBDU1NcbiAgICAgICAgekluZGV4OiAyZTksIC8vIFRoZSB6LWluZGV4IChkZWZhdWx0cyB0byAyMDAwMDAwMDAwKVxuICAgICAgICBjbGFzc05hbWU6ICdzcGlubmVyJywgLy8gVGhlIENTUyBjbGFzcyB0byBhc3NpZ24gdG8gdGhlIHNwaW5uZXJcbiAgICAgICAgdG9wOiAnNTAlJywgLy8gVG9wIHBvc2l0aW9uIHJlbGF0aXZlIHRvIHBhcmVudFxuICAgICAgICBsZWZ0OiAnNTAlJywgLy8gTGVmdCBwb3NpdGlvbiByZWxhdGl2ZSB0byBwYXJlbnRcbiAgICAgICAgc2hhZG93OiBmYWxzZSwgLy8gV2hldGhlciB0byByZW5kZXIgYSBzaGFkb3dcbiAgICAgICAgaHdhY2NlbDogZmFsc2UsIC8vIFdoZXRoZXIgdG8gdXNlIGhhcmR3YXJlIGFjY2VsZXJhdGlvblxuICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyAvLyBFbGVtZW50IHBvc2l0aW9uaW5nXG4gICAgfTtcblxuYWpheHNwaW5lci5zdGFydCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgc3Bpbm5lckNvbnRhaW5lciA9IG9wdGlvbnMuc3Bpbm5lckNvbnRhaW5lciB8fCAnYm9keSc7XG4gICAgdmFyIHNwaW5uZXJTaXplID0gb3B0aW9ucy5zcGlubmVyU2l6ZSB8fCAnbGFyZ2UnLFxuICAgICAgICBpc1NwaW5uZXJMb2FkaW5nVGV4dCA9IG9wdGlvbnMuaXNTcGlubmVyTG9hZGluZ1RleHQgfHwgZmFsc2UsXG4gICAgICAgIGlzT3ZlcmxheURpdiA9IHR5cGVvZiBvcHRpb25zLmlzT3ZlcmxheURpdiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmlzT3ZlcmxheURpdiA6IHRydWUsXG4gICAgICAgIG9wdHM7XG5cbiAgICBzd2l0Y2ggKHNwaW5uZXJTaXplKSB7XG4gICAgICAgIGNhc2UgJ3NtYWxsJzpcbiAgICAgICAgICAgIG9wdHMgPSAkLmV4dGVuZChkZWZhdWx0T3B0cywgeyBsaW5lczogMTEsIGxlbmd0aDogOCwgd2lkdGg6IDMsIHJhZGl1czogNiB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdtZWRpdW0nOlxuICAgICAgICAgICAgb3B0cyA9ICQuZXh0ZW5kKGRlZmF1bHRPcHRzLCB7IGxpbmVzOiAxMSwgbGVuZ3RoOiAxMCwgd2lkdGg6IDUsIHJhZGl1czogMTEgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDogLy9sYXJnZSBzaXplIGZvciBwYWdlXG4gICAgICAgICAgICBvcHRzID0gZGVmYXVsdE9wdHM7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgLy92YXIgYmFzZUNsYXNzID0gdGhpcztcbiAgICB2YXIgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzcGlubmVyQ29udGFpbmVyKTtcblxuICAgIC8vY2hlY2sgYW5kIGFkZCBcInBvc2l0aW9uOiByZWxhdGl2ZVwiIGZvciBzcGlubmVyIGNvbnRhaW5lclxuICAgIGlmICh0YXJnZXQuc3R5bGUucG9zaXRpb24gIT09ICdhYnNvbHV0ZScgfHwgdGFyZ2V0LnN0eWxlLnBvc2l0aW9uICE9PSAncmVsYXRpdmUnKSB7XG4gICAgICAgIHRhcmdldC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG4gICAgfVxuXG4gICAgLy9hZGQgYWpheCBvdmVybGF5IGRpdlxuICAgIGlmIChpc092ZXJsYXlEaXYgIT09IGZhbHNlKSB7XG4gICAgICAgIHZhciBvdmVybGF5RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIG92ZXJsYXlEaXYuY2xhc3NMaXN0LmFkZCgnYWpheC1vdmVybGF5Jyk7XG4gICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChvdmVybGF5RGl2KTtcbiAgICB9XG5cbiAgICBzcGlubmVyID0gbmV3IFNwaW5uZXIob3B0cykuc3Bpbih0YXJnZXQpO1xuICAgIGlmICh0eXBlb2YgaXNTcGlubmVyTG9hZGluZ1RleHQgIT09ICd1bmRlZmluZWQnICYmIGlzU3Bpbm5lckxvYWRpbmdUZXh0ID09PSB0cnVlKSB7XG4gICAgICAgIHZhciBzcGlubmVyTG9hZGluZ1RleHREaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdmFyIHRleHROb3RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ0xvYWRpbmcgbW9yZSAuLi4nKTtcbiAgICAgICAgc3Bpbm5lckxvYWRpbmdUZXh0RGl2LmFwcGVuZENoaWxkKHRleHROb3RlKTtcbiAgICAgICAgc3Bpbm5lckxvYWRpbmdUZXh0RGl2LmNsYXNzTGlzdC5hZGQoJ3NwaW5uZXJMb2FkaW5nVGV4dCcpOyAgICAgICAgXG4gICAgICAgIHNwaW5uZXJMb2FkaW5nVGV4dERpdi5jbGFzc0xpc3QuYWRkKHNwaW5uZXJTaXplKTtcbiAgICAgICAgc3Bpbm5lci5lbC5hcHBlbmRDaGlsZChzcGlubmVyTG9hZGluZ1RleHREaXYpO1xuICAgIH1cbn07XG5cbmFqYXhzcGluZXIuc3RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICBzcGlubmVyLnN0b3AoKTtcbiAgICAkKHNwaW5uZXJDb250YWluZXIpLmZpbmQoJy5hamF4LW92ZXJsYXknKS5yZW1vdmUoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gYWpheHNwaW5lcjsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBhamF4c3BpbmVyID0gcmVxdWlyZSgnLi9hamF4c3BpbmVyJyk7XG5cbmZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICBpZih0eXBlb2YgdXNlcklkICE9PSAndW5kZWZpbmVkJyAmJiB1c2VySWQgIT09ICcnKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIG9wZW5BamF4UG9wdXAodXJsLCBwb3B1cFNlbGVjdG9yKSB7ICAgIFxuICAgICQubWFnbmlmaWNQb3B1cC5vcGVuKHtcbiAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgIHNyYzogcG9wdXBTZWxlY3RvclxuICAgICAgICB9LFxuICAgICAgICBjYWxsYmFja3M6IHtcbiAgICAgICAgICAgIGJlZm9yZU9wZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGFqYXhzcGluZXIuc3RhcnQoe1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyQ29udGFpbmVyOiBwb3B1cFNlbGVjdG9yXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxudmFyIHV0aWwgPSB7XG4gICAgaXNBdXRoZW50aWNhdGVkOiBpc0F1dGhlbnRpY2F0ZWQsXG4gICAgb3BlbkFqYXhQb3B1cDogb3BlbkFqYXhQb3B1cFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1dGlsOyIsIid1c2Ugc3RyaWN0JztcblxudmFyIHNlYXJjaCA9IHJlcXVpcmUoJy4vc2VhcmNoJyk7XG5cbmZ1bmN0aW9uIHRvZ2dsZU1lbnUoKSB7XG4gICAgJCgnLnRvZ2dsZS1tZW51Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAkKCdib2R5JykudG9nZ2xlQ2xhc3MoJ21vYmlsZS1tZW51Jyk7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB0b2dnbGVNZW51KCk7XG4gICAgc2VhcmNoLmluaXQoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgaW5pdDogaW5pdFxufSIsIid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gYmluZEF1dG9Db21wbGV0ZShkYXRhKSB7XG4gICAgdmFyICRzZWFyY2hTdWdnZXN0aW9uID0gJCgnI3NlYXJjaC1zdWdnZXN0aW9uJyk7ICAgIFxuICAgICRzZWFyY2hTdWdnZXN0aW9uLmVtcHR5KCk7IFxuXG4gICAgaWYoZGF0YSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgbGVuID0gZGF0YS5zdWdnZXN0aW9ucy5sZW5ndGg7XG4gICAgdmFyIHJlc3VsdCA9ICc8dWw+JzsgICAgXG4gICAgJC5lYWNoKGRhdGEuc3VnZ2VzdGlvbnMsIGZ1bmN0aW9uKGluZGV4LCBpdGVtKSB7ICAgICAgICBcbiAgICAgICAgcmVzdWx0ICs9ICc8bGk+PGEgaHJlZj1cIi9zZWFyY2g/d29yZD0nICsgaXRlbS5zZWxlY3QgKyAnJnR5cGU9dmlcIj4nICsgJChpdGVtLmRhdGEpLmh0bWwoKSArICc8L2E+PC9saT4nO1xuICAgIH0pO1xuICAgICRzZWFyY2hTdWdnZXN0aW9uLmFwcGVuZChyZXN1bHQgKyAnPC91bD4nKTtcbn1cblxuZnVuY3Rpb24gc2VhcmNoQXV0b2NvbXBsZXRlKCkge1xuICAgICQoXCIjd29yZFwiKS5vbignaW5wdXQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyICRzZWxmID0gJCh0aGlzKTtcbiAgICAgICAgdmFyIHdvcmQgPSAkc2VsZi52YWwoKS50cmltKCk7XG4gICAgICAgIGlmKHdvcmQgPT09ICcnKSB7XG4gICAgICAgICAgICBiaW5kQXV0b0NvbXBsZXRlKG51bGwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IFxuXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6IFwiL2FwaS92aWRpY3QvYXV0b2NvbXBsZXRlL1wiICsgJCh0aGlzKS52YWwoKS50cmltKCksICAgICAgICAgICAgICBcbiAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7ICAgICAgXG4gICAgICAgICAgICAgICAgYmluZEF1dG9Db21wbGV0ZShkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7ICAgICBcbiAgICB9KTsgICAgXG59XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgc2VhcmNoQXV0b2NvbXBsZXRlKCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGluaXQ6IGluaXRcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgY29uc29sZS5sb2coJ0hvbWUgUGFnZScpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBpbml0OiBpbml0XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiByZXNldE5vdGljZSgpIHtcbiAgICB2YXIgJG5vdGljZSA9ICQoJyNub3RpY2UnKTtcbiAgICAkbm90aWNlLmZpbmQoJy5jb3JyZWN0JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAkbm90aWNlLmZpbmQoJy5pbmNvcnJlY3QnKS5hZGRDbGFzcygnaGlkZScpLnRleHQoJycpO1xuICAgICRub3RpY2UuZmluZCgnLmJ0bi1pZ25vcmUnKS5zaG93KCk7XG4gICAgJCgnLmJ0bi1jaGVjaycpLnRleHQoJ0NoZWNrJyk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrKCkge1xuICAgIHZhciBhcnJRdWVzdGlvbnMgPSAkKCcucXVlc3Rpb24tY29udGFpbmVyJykudG9BcnJheSgpLCBxSW5kZXggPSAxO1xuICAgICQoJy5idG4tY2hlY2snKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciAkc2VsZiA9ICQodGhpcyksXG4gICAgICAgICAgICAkcXVlc3Rpb25Db250YWluZXIgPSAkc2VsZi5wYXJlbnRzKCcucXVlc3Rpb24tY29udGFpbmVyJyksICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICRoZGZBbnN3ZXIgPSAkcXVlc3Rpb25Db250YWluZXIuZmluZCgnLmhkZkFuc3dlcicpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhhcnJRdWVzdGlvbnMpO1xuXG4gICAgICAgIGlmICgkc2VsZi50ZXh0KCkgPT09ICdDaGVjaycpIHtcbiAgICAgICAgICAgIHZhciB1c2VyQW5zd2VyID0gJyc7XG4gICAgICAgICAgICAvLyBnZXQgdXNlckFuc3dlclxuICAgICAgICAgICAgaWYoJHF1ZXN0aW9uQ29udGFpbmVyLmRhdGEoJ3R5cGUnKSA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHVzZXJBbnN3ZXIgPSAkcXVlc3Rpb25Db250YWluZXIuZmluZCgnaW5wdXRbdHlwZT1yYWRpb106Y2hlY2tlZCcpLnZhbCgpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoJHF1ZXN0aW9uQ29udGFpbmVyLmRhdGEoJ3R5cGUnKSA9PT0gMiB8fCAkcXVlc3Rpb25Db250YWluZXIuZGF0YSgndHlwZScpID09PSAzIHx8ICRxdWVzdGlvbkNvbnRhaW5lci5kYXRhKCd0eXBlJykgPT09IDQpIHtcbiAgICAgICAgICAgICAgICB1c2VyQW5zd2VyID0gJHF1ZXN0aW9uQ29udGFpbmVyLmZpbmQoJy50eHQtYW5zd2VyJykudmFsKCkudHJpbSgpO1xuICAgICAgICAgICAgfSAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAvLyBhbnN3ZXJcbiAgICAgICAgICAgIHZhciBhbnN3ZXIgPSAkaGRmQW5zd2VyLnZhbCgpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodXNlckFuc3dlciA9PT0gYW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgJHF1ZXN0aW9uQ29udGFpbmVyLmFkZENsYXNzKCdwYXNzZWQnKTtcbiAgICAgICAgICAgICAgICAkKCcjbm90aWNlJykuZmluZCgnLmNvcnJlY3QnKS5yZW1vdmVDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgICAgICQoJyNub3RpY2UnKS5maW5kKCcuaW5jb3JyZWN0JykuYWRkQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICAkKCcjbm90aWNlJykuZmluZCgnLmJ0bi1pZ25vcmUnKS5oaWRlKCk7XG4gICAgICAgICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAkKCcjbm90aWNlJykuZmluZCgnLmNvcnJlY3QnKS5hZGRDbGFzcygnaGlkZScpO1xuICAgICAgICAgICAgICAgICQoJyNub3RpY2UnKS5maW5kKCcuaW5jb3JyZWN0JykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICAkKCcjbm90aWNlJykuZmluZCgnLmluY29ycmVjdCcpLnRleHQoJ0NvcnJlY3QgaXMgOiAnICsgJHF1ZXN0aW9uQ29udGFpbmVyLmZpbmQoJy5oZGZBbnN3ZXInKS52YWwoKSk7XG4gICAgICAgICAgICAgICAgJCgnI25vdGljZScpLmZpbmQoJy5idG4taWdub3JlJykuaGlkZSgpO1xuICAgICAgICAgICAgfSAgICAgICAgICBcblxuICAgICAgICAgICAgJHNlbGYudGV4dCgnQ29udGludWUnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRxdWVzdGlvbkNvbnRhaW5lci5mYWRlT3V0KDUwMCwgZnVuY3Rpb24gKCkgeyAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXNldE5vdGljZSgpO1xuICAgICAgICAgICAgICAgIGlmKGFyclF1ZXN0aW9ucy5sZW5ndGggPiBxSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgJChhcnJRdWVzdGlvbnNbcUluZGV4XSkuZmFkZUluKDUwMCk7XG4gICAgICAgICAgICAgICAgICAgIHFJbmRleCsrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKCQoJy5xdWVzdGlvbi1jb250YWluZXI6bm90KC5wYXNzZWQpJykubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJyUXVlc3Rpb25zID0gJCgnLnF1ZXN0aW9uLWNvbnRhaW5lcjpub3QoLnBhc3NlZCknKS50b0FycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBxSW5kZXggPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5xdWVzdGlvbi1jb250YWluZXI6bm90KC5wYXNzZWQpOmZpcnN0JykuZmFkZUluKDUwMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjZmluaXNoJykucmVtb3ZlQ2xhc3MoJ2hpZGUnKTtcbiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gcGxheVNvdW5kKCkgeyBcbiAgICAkKCcuc291bmQnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIGF1ZGlvID0gbmV3IEF1ZGlvKCQodGhpcykuZGF0YSgnc3JjJykpO1xuICAgICAgICBhdWRpby5wbGF5KCk7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBjaGVjaygpO1xuICAgIHBsYXlTb3VuZCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBpbml0OiBpbml0XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdXRpbCcpLFxuICAgIGFqYXggPSByZXF1aXJlKCcuLi9oZWxwZXJzL2FqYXgnKTtcblxuZnVuY3Rpb24gb3BlbkFkZFdvcmRQb3B1cCgpIHtcbiAgICAkKCcjYWRkVG9MaXN0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmKCF1dGlsLmlzQXV0aGVudGljYXRlZCgpKSB7XG4gICAgICAgICAgICAkLm1hZ25pZmljUG9wdXAub3Blbih7XG4gICAgICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3JjOiAnLmF1dGhlbi1wb3B1cCcgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJC5tYWduaWZpY1BvcHVwLm9wZW4oe1xuICAgICAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIHNyYzogJy5hZGQtdG8tbGlzdC1wb3B1cCdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrczoge1xuICAgICAgICAgICAgICAgICAgICBiZWZvcmVPcGVuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBhamF4LmdldCgnL2FwaS9saXN0cycpLmRvbmUoZnVuY3Rpb24obGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gobGlzdHMsIGZ1bmN0aW9uKGluZGV4LCBsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgKz0gJzxvcHRpb24gdmFsdWU9XCInICsgbGlzdC5faWQgKyAnXCI+JyArIGxpc3QudGl0bGUgKyAnPC9vcHRpb24+JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuYWRkLXRvLWxpc3QtcG9wdXAgI2xpc3QnKS5lbXB0eSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5hZGQtdG8tbGlzdC1wb3B1cCAjbGlzdCcpLmFwcGVuZChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gYWRkV29yZFRvTGlzdCgpIHtcbiAgICB2YXIgJGFkZFRvTGlzdFBvcHVwID0gJCgnI2FkZC10by1saXN0LXBvcHVwJyk7XG4gICAgJGFkZFRvTGlzdFBvcHVwLm9uKCdjbGljaycsICdidXR0b24nLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICB3b3JkOiAkYWRkVG9MaXN0UG9wdXAuZmluZCgnLmhlcm8tdGl0bGUnKS50ZXh0KCksXG4gICAgICAgICAgICB0cmFuc2xhdGVUb0VuOiAnJyxcbiAgICAgICAgICAgIHRyYW5zbGF0ZVRvVmk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250ZW50X3NlbGVjdGFibGUnKS5vdXRlckhUTUwsXG4gICAgICAgICAgICBsaXN0SWQ6ICRhZGRUb0xpc3RQb3B1cC5maW5kKCcjbGlzdCcpLnZhbCgpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnL2FwaS93b3JkcycsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgb3BlbkFkZFdvcmRQb3B1cCgpO1xuICAgIGFkZFdvcmRUb0xpc3QoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgaW5pdDogaW5pdFxufSJdfQ=="}